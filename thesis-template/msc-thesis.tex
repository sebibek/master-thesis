% This template was initially provided by Dulip Withanage.
% Modifications for the database systems research group
% were made by Conny Junghans,  Jannik StrÃ¶tgen and Michael Gertz

\documentclass[
     12pt,         % font size
     a4paper,      % paper format
     BCOR10mm,     % binding correction
     DIV14,        % stripe size for margin calculation
%     liststotoc,   % table listing in toc
%     bibtotoc,     % bibliography in toc
%     idxtotoc,     % index in toc
%     parskip       % paragraph skip instad of paragraph indent
     ]{scrreprt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% PACKAGES:

% fix bitmap fonts
\usepackage{lmodern}
% Use German :
\usepackage[ngerman,english]{babel}
\usepackage{amsmath}
% Input and font encoding
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
% Index-generation
\usepackage{makeidx}
% Einbinden von URLs:
\usepackage{url}
% Special \LaTex symbols (e.g. \BibTeX):
%\usepackage{doc}
% Include Graphic-files:
\usepackage{graphicx}
% Include doc++ generated tex-files:
%\usepackage{docxx}
% Include PDF links
%\usepackage[pdftex, bookmarks=true]{hyperref}

% Fuer anderthalbzeiligen Textsatz
\usepackage{setspace}

% hyperrefs in the documents
\usepackage[bookmarks=true,colorlinks,pdfpagelabels,pdfstartview = FitH,bookmarksopen = true,bookmarksnumbered = true,linkcolor = black,plainpages = false,hypertexnames = false,citecolor = black,urlcolor=black]{hyperref} 
%\usepackage{hyperref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% OTHER SETTINGS:

% Pagestyle:
\pagestyle{headings}

% Choose language
\newcommand{\setlang}[1]{\selectlanguage{#1}\nonfrenchspacing}


\begin{document}

% TITLE:
\pagenumbering{roman} 
\begin{titlepage}


\vspace*{1cm}
\begin{center}
\vspace*{3cm}
\textbf{ 
\Large Heidelberg University\\
\smallskip
\Large Institute of Computer Science\\
\smallskip
\Large Visual Computing Group (VCG)\\
\smallskip
}

\vspace{3cm}

\textbf{\large Master-Arbeit} % Bachelor-Arbeit 

\vspace{0.5\baselineskip}
{\huge
\textbf{Global Illumination Techniques for Tensor Field Visualization}
}
\end{center}

\vfill 

{\large
\begin{tabular}[l]{ll}
Sebastian Bek\\
Matrikelnummer: & 3481802\\
Betreuer: & Sebastian Bek\\
Datum der Abgabe: & 07.07.2019
\end{tabular}
}

\end{titlepage}

\onehalfspacing

\thispagestyle{empty}

\vspace*{100pt}
\noindent
\emph{dt.:}
Ich versichere, dass ich diese Master-Arbeit selbstständig verfasst und nur die angegebenen
Quellen und Hilfsmittel verwendet habe und die Grundsätze und
Empfehlungen ``Verantwortung in der Wissenschaft'' der Universität Heidelberg beachtet wurden. 
\bigskip
\\
\emph{eng.:}
I hereby declare/assure, that I drafted this thesis independently and only used the sources and materials labeled as references and that the conventions/principles and recommendations ``Verantwortung in der Wissenschaft'' of the Heidelberg University have been regarded/observed. 
\vspace*{50pt}
\noindent

\underline{\phantom{mmmmmmmmmmmmmmmmmmmm}}

\medskip
\noindent 
Abgabedatum / Due Date: 07.07.2019
\newpage

% Add a brief summary of your topic and contributions (Zusammenfassung) in German *and* in English:
\chapter*{Zusammenfassung}
%\input{zusammenfassung}

Tensorfelder werden meistens in Verbindung mit mechanischen Spanunngsverteilungen in 2D/3D-Gittern gebracht (vgl. Cauchy-Stress Tensor), haben aber auch andere praktische Bedeutungen in der Physik.
Mithilfe von globalen Beleuchtungsmodellen/-techniken wird eine neue Methode entwickelt, um Tensorfelder zu visualisieren, die aber zusätzlich auch verwendet werden kann um die Lichtausbreitung in einer topologischen Szene zu beschreiben. Als Grundlage leiten wir ein einfaches Lichtausbreitungsschema für kartesische Gitter ab, dass die Prinzipien der Ausbreitungsdämpfung und Energieerhaltung beachtet und Licht-verteilung/en für gegebene Lichtquellenrichtung/en und -positionen bis zur Konvergenz approximieren kann. Als unterliegendes Modell werden die Transmissionsprofile innerhalb diesem Gitter als Kristallfiberstruktur angenommen (vgl. Edelsteine: Katzenaugeneffekt beim Tigerauge). Die folgende Aufgabe ist es, anisotrope Fiberstrukturen mit der Orientierung und den Anisotropiemaßen des unterliegenden Tensorfelds zu modellieren. Dafür erstellen wir per Hauptachsentransformation (PCA) ein Eigensystem für jede Zelle des Tensorfelds und modellieren eine zugehörige Ellipsengleichung als (Transfer-/Wichtungs-) Transmissionsprofil. Folglich kann die resultierende Lichtverteilung als 2D Skalarfeld oder Polarplots für Richtungsinformation visualisiert/repräsentiert werden. Wir messen Impulsantworten des Tensorfelds mit Delta-Pulsen an jeder Position und in jede Richtung um eine uniform gesamplete Map der globalen Lichtverteilungen zu erhalten. Diese Map wird als ein globales Energieflussfeld betrachtet. Wir lassen uns von der Technik FTLE aus dem Bereich Particle Tracing der Vector Field Visualization inspirieren, indem wir den Gradient des Flussfelds der resultierenden Lichtverteilungen analysieren und visualisieren. Ähnlich wie FTLE in Vektorfeldern Gräte/Kämme/LCS detektiert, erfasst unsere Methode dieselben Strukturen, anziehende/abstoßende/sattelnde Tensorfeldlinien die häufig Schlüsselstrukturen in der Natur repräsentieren, in Tensorfeldern. Wir führen diese Größe als Global Illumination Gradient ein, der einen FTLE-verwandten Ansatz darstellt, um LCS in Tensorfeldern durch die Analyse des globalen, durch einen Imprint (Gravur in kristallinen Fiberstrukturen) gerichteten Lichtflusses, zu visualisieren. Außerdem führen wir Deformation Ellpsoid Glyphen ein, die zusätzlich zur Darstellung der anisotropen Topologie die Richtung(Zug-/Druck) der Spannung durch Pfeile nach innen/außen darstellen. Das Verfahren wird in einer extensiven Evaluationsphase auf Plausibilität und Vergleichbarkeit geprüft.
\newpage

\chapter*{Abstract}
%\input{abstract}
Tensor Fields, are most commonly associated with stress distributions (cnf. Cauchy-Stress Tensor) in 2D/3D grids, but also have some other meanings in practice in physics. By means of global illumination techniques, we develop a new method to visualize tensor fields, which is also capable of visualizing the light transport (propagation) in a topologically defined scene geometry. As a basis, we derive a simple light propagation scheme for Cartesian grids, which satisfies propagation attenuation and energy-conservation principles and is able to approximate light distributions for given light source position(s) and direction(s) until convergence. The transmission profiles within this grid are considered as crystal fiber structures as an underlying physical model (eg. gemstones: tiger's eye's cat's eye effect). The consequent task is to model anisotropic fibre structures with the orientation and anisotropy measures of the underlying tensor field in the grid.
For this, we derive an eigenbasis by PCA (principal component analysis) for every cell of the tensor field and form an ellipsoid equation as transmission (transfer/weighting) function for the transmitted light profiles. Hence, the resulting light distribution can be visualized via 2D scalar field or polar plots for directional information. Additionally, We measure impulse responses of the tensor field with Delta-Pulses as light sources at any (sampled) position and in any direction to generate a uniform sampled map of the global illumination distributions. This map is considered as a global illumination energy flow field.
We gain inspiration by vector field particle tracing's FTLE approach for analyzing the gradient of the flow field of the resulting light distributions. Similar to how the FTLE detects ridges/LCS (Lagrangian Coherent Structures) in vector fields (flow fields), our approach captures these structures likewise, attracting/repelling/saddling tensor field lines (TFL) which frequently represent key structures in nature, in tensor fields. We denote this entity a global illumination gradient which states an FTLE-related approach for visualizing LCS in tensor fields through analysis of the global and light transport  directed by imprint/engraving in crystelline fiber structures. 
We also introduce Deformation Ellipsoid Glyphs which are, additionally to visualizing anisotropic topology, pointing inward/outward for compressive/tensile stresses visualizing orientation of principal mechanical stresses.
We evaluate our approaches for plausibility and comparability within an extensive test campaign.
\newpage

% MAIN PART:
% Table of contents (Inhaltsverzeichnis)
\tableofcontents
\cleardoublepage
\pagenumbering{arabic} 

% List of figures (Abbildungsverzeichnis):
%\listoffigures
% List of tables (Tabellenverzeichnis):
%\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Here, the actual content of your thesis begins
% You can either put all the text here or use individual files to store the chapters of your thesis.
% Below are templates for both alternatives.

\chapter{Introduction}\label{intro}

In this work, we wil discuss the advantages of tensor field analysis and develop a new method for tensor field and a coherent light transport visualization. At first, we will shortly state the problem setting objectives and then give a quick overview about the structure of this work.

%Dieses Kapitel gibt einen Überblick über die Arbeit. Gerade der
%Abschnitt zur Motivation soll allgemein verständlich geschrieben
%werden. Die Einleitung sollte auch wichtige Referenzen enthalten. 

\section{Motivation}

Tensor Field Visualization is gaining importance as a relevant tool for the analysis of fluid and solid mechanics. Tensors are found most commonly in medical, scientific and engineering applications. A tensor is a $n$-D generalization of a matrix and appears e.g. as Jacobi-Matrix in Vector (Flow) Field Visualization or as stress tensor in solid continuum mechanics. Basically, tensors describe compressions, tensions, rotations and volume changes in both solid and fluid material. While most techniques focus on symmetric tensor field visualization (like Glyphs and Tensor Field Lines), some other recent works adress the problem of asymmetric tensor field visualization. The issue with asymmetric or antisymmetric tensors is that they do not always yield real eigenvalues, which is needed to determine an eigenbasis to set up glyphs, hyperstreamlines or tensor field lines. \cite{pang&zheng} et.al. proposed the concept of dual eigenvectors and \cite{zhang} extended it to pseudo-eigenvectors and introduced eigenvector and eigenvalue manifold to visualize eigenvectors in the complex domain. In this work, we will use the $\mathbf{U}$-matrix obtained from singular value decomposition (SVD) to obtain the half-axes of the PCA principal ellipsoid as suggested by \cite{moler}.\\


\begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/DIFFERENT_TYPES_OF_STRESS.png}
  }
  \caption{Different types of stresses}
  \label{Skalierung}
\end{figure}


Worum geht es? Beispiel(e)! Illustrationen sind hier meist sinnvoll
zum Verständnis. Warum ist das Thema wichtig? In welchem Kontext?

\section{Objectives}
\begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/hyperstreamlines.png}
  }
  \caption{Hyperstreamlines in Tensor Field Visualization}
  \label{Skalierung}
\end{figure}
The problem setting encomprises the visualization of tensor fields, i.e. mostly 2D/3D-grids consisting of mainly second-order tensors (cnf. Cauchy-Stress Tensor) with the additional possibility to model light transport transport in a geometrical scene. The main purpose of visualization in general is to reduce or encode some set of numbers in some readable, explorable and more intuitive representation. This implies e.g.clustering, structuring or projection techniques. The objective of this work is to develop a simple light propagation scheme to generate a tensor-induced flow map. The tensors are decomposed via singular value decomposition to obtain a real eigenbasis as transmission profile. Another aim is to implement a vector-field visualization borrowed FTLE-related approach in tensor field visualization (both symmetric and asymmetric) for detecting ridges/LCS (Lagrangian Coherent Structures). These structures can be classified (identified) as repelling, attracting and saddling (forming a saddle) local features, which frequently represent key structures in nature. LCS usually separate regions of different flow behavior, but in our case they separate regions/domains of differing stress distributions. The map responds most where tensor field lines / hyperstreamlines converge or diverge, whereas one is the same as the other because of bidirectional stress directions. The real part of the eigenvalues can be exploited for sign change (contractions/tensions) which leads to the concept of deformation glyphs w. attached arrows pointing inward/outward for the two types of normal stresses. Practically, in its eigenbasis there are no shear stresses existent for the symmetric stress tensor in equilibrium, just the principal normal stresses. Thus, we can even define the full set of stresses with the deformation glyphs which are derived from the singular value decomposition and signed with the real part of the eigenvalues (in corresponding absolute order). 


In diesem Abschnitt sollen neben den Herausforderungen und der
Problemstellung insbesondere die Ziele der Arbeit beschrieben werden. 

\section{Structure of this work}
 
For the rest of this work, we will give a quick overview on the structure and outline. Next, in chap. \ref{chap:grundlagen}, we will capture important fundamentals like Tensors and PCA in the context of singular value decomposition (generalization of eigenvalue decomposition). Also we will discuss the most relevant work in the domain of tensor field visualization. In chap. \ref{chap:main} we will propose the main contributions of this work and document the experimental evaluation in chap. \ref{chap:eval}. A compact Summary, Conclusion and Outlook will be given in chap. \ref{chap:concl}.\\

%Dieser Abschnitt wird meist recht kurz gehalten und beschreibt im
%Prinzip nur den Aufbau des Rests der Arbeit. Zum Beispiel: In Kapitel
%\ref{chap:grundlagen} geben wir einen Überblick über die  Grundlagen
%zu der Arbeit sowie über verwandte Arbeiten. In Kapitel
%\ref{chap:main} stellen wir dann \ldots vor. \ldots etc.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\chapter{Fundamentals and Recent Work}
\label{chap:grundlagen}

In this chapter, we will capture the prerequisites necessary to understand the contributions of this work and will capture Tensors, PCA and Related Work in that sense.\\

%Die ersten paar Abschnitte in diesem Kapitel führen in die Grundlagen
%zur Arbeit ein. Das können beispielsweise Grundlagen zu Netzwerken
%oder zur Informationsextraktion sein. 

\section{Tensors}
\label{sec:tensors}
Now what is a Tensor? A tensor is a $o$-dimensional generalization of a matrix as follows:
\begin{center}
 \begin{tabular}{c|c|c|c|c|c|c}
\textbf{order} & 0 & 1 & 2 & 3 & ... & o \\ 
\hline 
\textbf{shape} & scalar & vector & matrix & "3D-matrix" & ... & oD-matrix\\ 
\end{tabular}\vskip 5pt
Table 1: Tensor Shapes
 \end{center} 
 
In addition to that, a tensor has as many indices as its order $o$ and their run length is as long as its embedded dimension $n$, which is equal to the rank of the tensor for full rank (or in other words the number of elements n for a $nxn$-matrix). Tensors follow certain transformation rules which are defined for covariant/contravariant tensors. They are most commonly obtained and defined from physical transformation equations. Hence, any $o$-D number array could be a tensor, but the definition holds only if the transformation rules apply to these $o$-D number arrays (in a sense of physical interpretation), which is mostly true for component-indexed $o$D number entities following matrix multiplication and transformation rules found in physics and math. In fact, tensors themselves are interpreted as a transformation which reflects an incoming direction vector (measuring e.g. the stress in that direction) to an outgoing stress vector.
 To be a bit more concrete, tensors represent stress distributions in solids and fluids describing strain and flow features as these entities aren't simple numbers or vectors. They occur in form of a tensor fields, and thus as entities or quantities in physics. That is, at each point in space (the grid) there is a whole distribution of e.g. stresses (elastic and viscous) which needs to be characterized and represented by a single tensor.
 \\
 \emph{Cauchy stress tensor}
 \begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/stress_tensor.png}
  }
  \caption{Cauchy-Stress Tensor}
  \label{cauchy}
\end{figure}

The Cauchy stress tensor, which is propably the classical example of a tensor, is depicted in Fig. \ref{cauchy} and consists of 3 stress vectors $\mathbf{T(e_i)}$ arranged in row-major order. It appears in similar form as viscous stress tensor in fluid mechanics:
\begin{align*}
\boldsymbol{\sigma_{ij}}
 = \left[{\begin{matrix} \mathbf{T}^{(\mathbf{e}_1)} \\
\boldsymbol{T}^{(\mathbf{e}_2)} \\
\boldsymbol{T}^{(\mathbf{e}_3)} \\
\end{matrix}}\right] =
\left[{\begin{matrix}
\sigma _{xx} & \sigma _{xy} & \sigma _{xz} \\
\sigma _{yx} & \sigma _{yy} & \sigma _{yz} \\
\sigma _{zx} & \sigma _{zy} & \sigma _{zz} \\
\end{matrix}}\right]  = \left[{\begin{matrix}
\sigma _x & \tau _{xy} & \tau _{xz} \\
\tau _{yx} & \sigma _y & \tau _{yz} \\
\tau _{zx} & \tau _{zy} & \sigma _z \\
\end{matrix}}\right] =
\begin{bmatrix}
\sigma _{11} & \sigma _{12} & \sigma _{13} \\
\sigma _{21} & \sigma _{22} & \sigma _{23} \\
\sigma _{31} & \sigma _{32} & \sigma _{33} 
\end{bmatrix}
\end{align*}
These 3 stress vectors represent the orientation and magnitude of total resulting stress at plane ${x,y,z}$ in direction ${x,y,z}$ (9 individual numbers). Thus, the stress tensor poses a full valid represenation of the stress distribution at any point in space. The stress tensor itself can be interpreted as a transformation which maps an incoming normal direction vector $\mathbf{n}$ a resulting stress vector $\mathbf{T^{(n)}} = \mathbf{n}\cdot\boldsymbol{\sigma}$. The stresses in normal directions (diagonal elements) are directly related to the pressure, which is always isotropic and hence non-directionally dependent. It is possible to find 3 principal stress directions in 3D through PCA (see sect. \ref{sec:pca} below), for which there are no shear stresses existent in equilibrium. These form the principal directions of deformation at a certain location and are sufficient to describe the resulting transformation/deformation behaviour. The resulting system of principal directions and absolute stresses is often called an "eigensystem" or "eigenframe". So to say, an eigensystem, consistent of the principal directions/axes, spans a principal ellipsoid depicted in Fig. \ref{HAT} in sect. \ref{sec:pca}.

\section{Principal Component Analysis}
\label{sec:pca}
Note that we denote a matrix as a second order tensor interchangeably for the sake of simplicity in the following. For any state of stress in equilibrium it is possible to find $n$ (dimensionality) independent orthogonal directions with no shear stresses existent. Along these directions the principal stresses, which are normal (tensile/compressive) stresses, are exerted. The anisotropy can be represented by e.g. ellipsoid glyphs.

\begin{figure}[h]
%\centering
  \begin{minipage}{0.5\textwidth}
    \includegraphics[width=\textwidth]{img/HAT.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.5\textwidth}
    \includegraphics[width=\textwidth]{img/glyphs.png}
    \label{b)}
  \end{minipage}
\caption{a) Principal Component Analysis, b) Ellipsoid Glyphs w. anisotropy coefficient (l:linear, p:planar, s:spherical)}
\label{gradient}
\end{figure}

Principal Component Analysis is an algorithm which can capture the principal components (directions) in stochastic data. But it works similarly on transformations to capture the principal directions from transformations like rotation and scaling. Now, principal component analysis can be done by eigenvalue or singular vector decomposition, whereas the former yields complex eigenvalues for asymmetric matrices. For (anti-)symmetric (normal) matrices, they are connected through the following relation: $s_i = \sqrt{|\lambda_i|}$ (cnf. \cite{kieburg}). Mathematically speaking, a decomposition is somehow decomposing a transformation (which follows certain transformation rules) into parts of subsequent transformations consistent of rotation and scaling ($\mathbf{A} = \mathbf{R}\mathbf{S}\mathbf{R}^*$). We choose to use singular value decomposition ($\mathbf{A} = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^*$) to be able to set up real eigenvalues for any kind of matrix (singular values are always real and positive). Also, the singular vectors of the $\mathbf{U}$-matrix represent the half-axes of the principal ellipsoid (eigenframe) shown in Fig. \ref{HAT} for any kind of matrix as pointed out by \cite{moler}. In addition, we also calculate the eigenvalues to exploit the sign of the real part of the eigenvalues (\cite{mroz}) ordered decreasingly by absolute value (corresponding to singular value order). The sign corresponds to tensile ($+$) and compressive ($-$) stress, which would allow us to visualize deformation glyphs with arrows pointing inwards for compressive and outwards for tensile stresses. We do this decomposition analysis once for each matrix and then store the precomputed results in a grid. The principal ellipsoid is also used as a transmission profile for the propagation scheme in symbolic form in a subequent step. In this work, we will use the singular vectors yielded from singular value decomposition to avoid complex values yielded from eigenvalue decomposition. This will allow us to set up glyphs representing the major/minor axis of the underlying transformation for every kind of (asymmetric/symmetric) tensor. We will then use global-illumination techniques on top to generate a flow map, which permits us to compute an FTLE-like field on the tensor fields.
\vskip 5pt
\section{Related Work}
\label{sec:related}

There has been extensive recent work on symmetric tensors but in comparison little on asymmetric ones.  Since we aren't able to cover the whole scope in this work, we will focus on the most relevant works about tensor field visualization. 

\textbf{Symmetric Tensor Field Visualization}\\
\cite{pang&zheng} et.al. proposed a texture-based visualization approach called HyperLIC, which extends the concept of LIC to symmetric tensor fields by using an anisotropic 2D-filter kernel oriented along the major/minor eigenvectors. The concept of following the major/minor eigenvector along tensor field lines was invented by \cite{vilanova}. Tensorlines introduce a kind of artificial inertia (running average), making them resistent to noise. The notion of tensor field topology and the concept of Hyperstreamlines was first introduced by \cite{delmarcelle&hesselink}. The placement of tensor field lines as hyperstreamlines was recently improved by \cite{spencer} et.al. for glyph packing. A good overview of seeding strategies is given by \cite{mcloughlin}. \cite{feng} et. al. used Voronoi Tesselation for placing the glyphs. Superquadric glyphs have been proposed by \cite{schultz&kindlmann} for general (non-positive definite) tensors. \cite{deleeuw&vanwijk} visualize the partial derivative gradient, the Jacobian of the tensor field to sense the local properties of the field. A diffusion tensor can also be visualized by box \cite{makris}, ellipsoid \cite{pierpaoli}, composite \cite{worth} or superquadric \cite{kindlmann} glyphs. There is also a set of scalar measures available in symmetric tensor field visualization such as: mean diffusivity, fractional anisotropy \cite{basser} and anisotropy coefficients \cite{westin}. \cite{hlawatsch} et.al. obtain a coordinate (flow) map from tensor field lines following major/minor eigenvectors (fibre trajectories) and use the spectral norm of the Cauchy-Green deformation tensor to compute the FTLE-field in homogeneous regions. In a similar manner, we opt to use Global Illumination Techniques to obtain a light distribution footprinted (in form of weighting profiles obtained from ellipsoid glyphs) by the tensor field.
\\
\textbf{Asymmetric Tensor Field Visualization}\\
\cite{pang&zheng} et.al. proposed the concept of dual eigenvectors and \cite{zhang} extended it to pseudo-eigenvectors and introduced the eigenvector/eigenvalue manifolds to visualize eigenvectors in the complex domain. \cite{laramee} et.al. focused on the efficient implementation and visualization of these structures and provided an interactive visualization system for asymmetric tensors applicable in fluid and solid dynamics. The concept of Tensor Magnitude has been introduced by \cite{laramee2} for means of physical interpretation. They also proposed an efficient glyph and hyperstreamline hybrid approach, which made dynamic interaction in real-time in 2D tensor fields feasible. \cite{palacios} extracted isosurfaces of tensor magnitude, mode and isotropy index. 

Typischerweise im letzten Abschnitt dieses Kapitels wird dann auf
verwandte Arbeiten eingegangen. Entsprechende Arbeiten sind geeignet
zu zitieren. Beispiel: Die wurde erstmalig in den Arbeiten von Spitz
und Gertz \cite{Spitz2016a} gezeigt \ldots Details dazu werden in
dem Buch von Newman zu Netzwerken \cite{Newman2010} erläutert \ldots.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

% Alternative: put content in separate files
% Check the difference between including these files using \input{filename} and \include{filename} and see which one you like better
%\chapter{Einleitung}\label{intro}
%\input{introduction}
%
%\chapter{Voraussetzungen}\label{bg}
%\input{background}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\chapter{Main Part}
\label{chap:main}

This chapter will summarize the main contributions of this work studied and state targeted aims and goals as a first step in sect. \ref{sec:overview}. Then we will have a short introduction to the implemented global illumination scheme derived and simplified from an nVidia GI approach in sect. \ref{sec:scheme}. Last, we will state the effectively developed Visualization methods GIGradient and Deformation Glyphs proposed as innovatively invented tensor visualization techniques.



%Dieses Kapitel stellt meist den Hauptteil der Arbeit dar. Vor dem
%ersten Abschnitt sollte ein kurzer Überblick (ein paar wenige Sätze
%mit Verweise auf nachfolgende Abschnitte) gegeben werden. Beispiel: Im
%nachfolgenden Abschnitt \ref{sec:overview} wir ein Überblick über die Anforderungen an
%das Modell gegeben. 

\section{Requirements and Ambitions}
\label{sec:spec} 
Our ambition is to develop a simple and efficient Global Illumination Propagation Scheme able to distribute energy profiles in discrete polar form in 2D/3D-space w.r.t. energy conservation and propagation attenuation principles. We then generate transmission profiles from the eigensystems (principal component frames) of the tensors for each cell in the domain (field). That is, to provide an orientation for a grid of crystal fibre structures (cnf. optical fibres) to redirect the intensities in analogy to the anisotropies of the tensor field within a glyph representation, obtained from Principal Component Analysis. Our approach should be implicitly adaptive to any kind of 2D dataset. Thus, we opt to be compatible to handle any kind of matrix (symm./anti-symm.) and any kind of resolution of the field (full-spectrum). At last, we aim to generate a new FTLE-related method for tensor field visualization by applying a Global Illumination Gradient to the resulting light distributions for every possible position and direction of the light source in the grid generated by stimulation with Delta-Impulses. Thus, our motivation is to segment key locations (LCS/ridges) in the field with tensor field lines (hyperstreamlines) converging/diverging, which is necessarily the same (for bidirectional tensor fields). Our approach should efficiently handle (relatively) large datasets. 
Knapp zwei Seiten, in dem die Anforderungen, die Zielsetzung und die
Methoden überblicksartig beschrieben werden. Hier sollte die
Beschreibung ``technischer'' bzw.~``formaler'' sein als in der
Einleitung, da der Leser nun mit den Grundlagen und verwandten
Arbeiten vertraut ist.

\section{Global Illumination Scheme}
\label{sec:scheme}
Within the scope of this work, we will develop a Global Illumination Scheme designed to efficiently propagate the intensities stored in discrete polar coordinates given as impulses (stimuli) by the user or the config. Polar profiles for different light sources are shown in Fig. \ref{polar}:
\begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/strahler.png}
  }
  \caption{Types of forEmitters}
  \label{polar}
\end{figure}\vskip 3pt
Polar profiles map each angle $\varphi$ a magnitude $r$ forming a function $r(\varphi)$. They are circular axis versions of the domain $[0..2\pi]$, with negative magnitudes mirrored by 180 degrees). In the sense of interpretability, we exclude negative values (energies) from the scope of our calculations. As a start-up for the propagation, we will think of a grid cell in 2D as a center pixel within an 8-neighborhood. It has 8 (4 faces/edges and 4 diagonals) unique neighbors, which are adjacent point lights in the grid (the type of light source with theoretically no finite extend). We consider one face neighbor (top) to shortly explain the steps of the scheme. The diagonals and the others are obtained from derivation and symmetry.

Each cone (yellow and green) is an individual neighbor-dependent angular area. We optimize for distributing contributions for overlapping cones to transmit attenuated (because of the larger $\sqrt{2}$ distance) intensity in form of a shared part to the diagonals in a single step. Therefore, the intensity gathered in polar coordinates in areas marked in green, need to be partitioned between 2 of the 8 cone-index neighbors as follows:

\begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/scheme2.png}
  }
  \caption{Propagation Scheme}
  \label{scheme}
\end{figure}\vskip 3pt

The face neighbors take in the angular domain of $d_1=\alpha+2\beta$, whereas the diagonal neighbors span a domain of $d_2=2\beta$.
The linear combination weights for the overlapping (green) parts ($\beta$) are obtained from the relative overlapping angular area of $\beta$ w.r.t. diagonal cones ($2\beta$) and face cones ($\alpha+2\beta = 90^\circ$) (yellow cone is overlapped by green cones at full angle) subsequently normalized to $\sum = 1.0$ (normalization condition):
\begin{align}
	\varepsilon_1 &= \frac{\frac{\beta}{\alpha+2\beta}}{\frac{\beta}{\alpha+2\beta} + \frac{\beta}{2\beta}} \approx 0.362291\\
	\varepsilon_2 &= \frac{\frac{\beta}{2\beta}}{\frac{\beta}{\alpha+2\beta} + \frac{\beta}{2\beta}} \approx 0.63771
\end{align}

We place a cosine lobe scaled with the integrated (accumulated) energies in each of the 8 cone directions, whereas outgoing integrated and summed energies are weighted by the linear combination weights (factors) in overlapping (green) areas to split up the contributions accordingly. The contribution areas are depicted in Fig. \ref{scheme}, the cosine lobes can be observed in Fig. \ref{iter} respectively. This manner of propagation is inspired by the propagation scheme of \cite{dachsbacher} et.al. (see the paper on how to "project the flux into a point light"). The implementation is done in a dual buffer approach which pushes the energies back and forth (buffer A to buffer B) until convergence, which happens when the energy is spreaded throughout the grid and enters a stationary state, characterized by equal out (at grid borders) to in (at light source positions) energy-flow with no more nettings going on inside the domain. Note that even though we propagate the energy directly through the diagonal cones (which forms a square initially), the 8 degrees of freedom introduce a circular (spherical) wave front after few iterations (for greater resolutions). This occurs, since the diagonals are more strongly attenuated by default and there is a redistribution of intensities in the long term resulting in a circular torus-shaped distribution, as depicted in Fig. \ref{iter}. Also note, that this approach satisfies energy conservation and propagation attenuation principles and applies to the principles of light propagation in vacuum (by default). The verification of these principal requirements and specifications can be observed in the Experimental Evaluation in chap. \ref{chap:eval}.

We show a few of the first iteration steps for the propagation scheme in Fig. \ref{iter}:

\begin{figure}[h]
  \centering
 {
    \includegraphics[width=1.0\textwidth]
    {img/steps_gallery_format_arrow_alt.png}
  }
  \caption{Impulse Response for Isotropic Stimulus (Few Iterations: 0,1,2,3,7,11)}
  \label{iter}
\end{figure}\vskip 3pt

It can be proven that the approach follows propagation attenuation principles and follows the inverse (square) law ($\sim\frac{1}{r}$) as observed in the graph in Fig. \ref{att}. 

\begin{figure}[h]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/inverse_law.png}
  }
  \caption{Propagation Attenuation}
  \label{att}
\end{figure}\vskip 3pt

At last, we define a threshold for the minimum overall distribution error taken into account for convergence conditions, initiating a stop sequence when falling below that threshold. As already mentioned, a dual-buffer approach is chosen here, as we can efficiently propagate from one into the other and just swap pointers to 
start all over (after reinitialization). Another reason is it yields a reasonable source-target structure. Until now, we aimed to simulate the propagation of light in empty space (vacuum) providing us with a physically-motivated but very simplified base-approach. We aim to modulate the transmission of the energies on top of the base approach with transmission profiles obtained from the tensor fields through Principal Component Analysis and ellipsoid glyph equations in the following.


In diesem und den nachfolgenden Abschnitten werden die Beiträge der
Arbeit motiviert, formal sauber (oft mathematisch, sprich mit
Definitionen etc.) beschrieben, und bei Bedarf mithilfe von Beispielen
verdeutlicht. Die Beschreibungen in diesem Kapitel sind meist
unabhängig von einer konkreten Realisierung und Daten; diese werden im
nachfolgenden Kapitel detailliert.

\section{Transmission Profiles and Weighting Functions}
\label{sec:trans}
To obtain a kind of footprint of the tensor field, we set up ellipsoid equations for each glyph representation, obtained from applying PCA on each cell (tensor) in the field. We map the singular values (corresponding to eigenvalues) in decreasing order to the ellipses radii $a(\lambda_1 )$ and $b(\lambda_2 )$ as follows:

Ellipse Equation:
\begin{align}
	r(\theta) = \frac{ab}{\sqrt{a^{2}\sin^{2}(\theta-\varphi)+b^{2}\cos^{2}(\theta-\varphi)}} =\frac{\lambda_1\lambda_2}{\sqrt{\lambda_1^2\sin^2(\theta-\varphi)+\lambda_2^2\cos^2(\theta-varphi)}}
\end{align}
That is, the singular values form the half-axes of the PCA ellipsoid, which yields us a symbolic definition for our transmission (transfer) function as weighting profiles. We compute the offset angle $\varphi$ by exploiting the atan2-function with 4-quadrant evaluation for the first singular vector. As a preliminary prep, this profile is precomputed (sampled) for all discrete angular steps for each cell (e.g. $360$). The weighting scheme which we apply is depicted in Fig. \ref{weighting}.
\begin{figure}[h]
  \centering
  {
    \includegraphics[width=0.6\textwidth]
    {img/weighting.png}
  }
  \caption{red: Intensity Profile, cyan: Transmission Profile (Glyph Ellipsoid Eq.)}
  \label{weighting}
\end{figure}
We interpret the polar functions as discrete, sampled 1D vectors with a constant angular resolution. That means, we use element-wise multiplication for the 1D-vectors in red (Intensity Profile) and cyan (Transmission Profile) to obtain a windowed version of the intensity profile and perform the following integration step to accumulate the total radiant power (flux) as follows. Note that we model angular dependent radiant intensity $\mathbf{I}(\omega) [\frac{W}{\mathop{rad}}]$ as an underlying physical entity, which is well suited for describing point light sources:

\begin{align}
	\Phi_t = \int_0^{2\pi}\mathbf{I}(\omega)\mathbf{T}(w)\mathop{d\omega}
\end{align}

Now each tensor ellipse equation has a mean transmission rate $[\%]$, which turns out to be a measure or synonym for the total transmitted rate of the incoming intensity $\mathbf{I}(\omega)$. Since there can no energy be generated from transmission profiles (only transmitting, not generating), we have to normalize every tensor ellipse equation with the highest mean transmission rate in the field. This restricts the tensor ellipse mean to a maximum of 1.0 for the one with the highest tensor magnitude. Another problem that occurs with the weighting functions is that they can yield values above 1, which would potentially generate intensity out of nothing which leads to crucially unstable behaviour. Well, but only in case energy conservation principles were not respected. However, a proper normalization can give corrective remedy
\section{Global Illumination Gradient}
\label{sec:ftle}
Note that the resulting scalar field is $(n+1)$-dimensional ($x,y,z$ and direction $\theta$) and needs to be flattened by averaging or projection in 3D for proper visualization. 
Usw.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Experimentelle Evaluation}
\label{chap:eval}

Der Aufbau dieses Kapitels oder dessen Aufteilung in zwei Kapiteln ist
stark von dem Thema und der Bearbeitung des Themas
abhängig. Beschrieben werden hier Daten, die für eine Evaluation
verwendet wird (Quellen, Beispiele, Statistiken), die Zielsetzung der Evaluation
und die verwendeten Maße sowie die Ergebnisse (u.a.~mithilfe von
Charts, Diagrammen, Abbildungen etc.)

Dieses Kapitel kann auch mit einer Beschreibung der Realisierung eines
Systems beginnen (kein Quellcode, maximal Klassendiagramme!).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Zusammenfassung und Ausblick}
\label{chap:concl}

Hier werden noch einmal die wichtigsten Ergebnisse und Erkenntnisse
der Arbeit zusammengefasst (nicht einfach eine Wiederholung des
Aufbaus der vorherigen Kapitel!), welche neuen Konzepte, Methoden und
Werkzeuge Neues entwickelt wurden, welche Probleme nun (effizienter)
gelöst werden können, und es wird ein Ausblick auf weiterführende
Arbeiten gegeben (z.B.~was Sie machen würden, wenn Sie noch 6 Monate
mehr Zeit hätten).


% References (Literaturverzeichnis):
% a) Style (with abbreviations: use alpha):
% see
% https://de.wikibooks.org/wiki/LaTeX-W%C3%B6rterbuch:_bibliographystyle
% for the different formats and styles

\bibliographystyle{apalike}
% b) The File:
\bibliography{references}

\end{document}
