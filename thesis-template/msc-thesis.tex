	
% This template was initially provided by Dulip Withanage.
% Modifications for the database systems research group
% were made by Conny Junghans,  Jannik StrÃ¶tgen and Michael Gertz

\documentclass[enabledeprecatedfontcommands,
     12pt,         % font size
     a4paper,      % paper format
     BCOR10mm,     % binding correction
     DIV14,        % stripe size for margin calculation
%     liststotoc,   % table listing in toc
%     bibtotoc,     % bibliography in toc
%     idxtotoc,     % index in toc
%     parskip       % paragraph skip instad of paragraph indent
     ]{scrreprt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% PACKAGES:

% fix bitmap fonts
\usepackage{lmodern}
% Use German :
\usepackage[ngerman,english]{babel}
\usepackage{amsmath}
% Input and font encoding
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
% Index-generation
\usepackage{makeidx}
% Einbinden von URLs:
\usepackage{url}
% Special \LaTex symbols (e.g. \BibTeX):
%\usepackage{doc}
% Include Graphic-files:
\usepackage{graphicx}
% Include doc++ generated tex-files:
%\usepackage{docxx}
% Include PDF links
%\usepackage[pdftex, bookmarks=true]{hyperref}

% Fuer anderthalbzeiligen Textsatz
\usepackage{setspace}

\usepackage{caption}

% hyperrefs in the documents
\usepackage[bookmarks=true,colorlinks,pdfpagelabels,pdfstartview = FitH,bookmarksopen = true,bookmarksnumbered = true,linkcolor = black,plainpages = false,hypertexnames = false,citecolor = black,urlcolor=black]{hyperref} 
%\usepackage{hyperref}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% OTHER SETTINGS:

% Pagestyle:
\pagestyle{headings}

% Choose language
\newcommand{\setlang}[1]{\selectlanguage{#1}\nonfrenchspacing}
\newcommand*\mean[1]{\bar{#1}}
\newcommand{\source}[1]{\vspace{-3pt} \caption*{ Source: {#1}} }

\begin{document}

% TITLE:
\pagenumbering{roman} 
\begin{titlepage}


\vspace*{1cm}
\begin{center}
\vspace*{3cm}
\textbf{ 
\Large Heidelberg University\\
\smallskip
\Large Institute of Computer Science\\
\smallskip
\Large Visual Computing Group (VCG)\\
\smallskip
}

\vspace{3cm}

\textbf{\large Master-Arbeit} % Bachelor-Arbeit 

\vspace{0.5\baselineskip}
{\huge
\textbf{Light Transport Techniques for Tensor Field Visualization}
}
\end{center}

\vfill 

{\large
\begin{tabular}[l]{ll}
Sebastian Bek\\
Matrikelnummer: & 3481802\\
Betreuer: & Sebastian Bek\\
Datum der Abgabe: & 07.07.2019
\end{tabular}
}

\end{titlepage}

\onehalfspacing

\thispagestyle{empty}

\vspace*{100pt}
\noindent
\emph{dt.:}
Ich versichere, dass ich diese Master-Arbeit selbstständig verfasst und nur die angegebenen
Quellen und Hilfsmittel verwendet habe und die Grundsätze und
Empfehlungen ``Verantwortung in der Wissenschaft'' der Universität Heidelberg beachtet wurden. 
\bigskip
\\
\emph{eng.:}
I hereby declare/assure, that I drafted this thesis independently and only used the sources and materials labeled as references and that the conventions/principles and recommendations ``Verantwortung in der Wissenschaft'' of the Heidelberg University have been regarded/observed. 
\vspace*{50pt}
\noindent

\underline{\phantom{mmmmmmmmmmmmmmmmmmmm}}

\medskip
\noindent 
Abgabedatum / Due Date: 07.07.2019
\newpage

% Add a brief summary of your topic and contributions (Zusammenfassung) in German *and* in English:
\chapter*{Zusammenfassung}
%\input{zusammenfassung}

Tensorfelder werden meistens in Verbindung mit mechanischen Spanunngsverteilungen in 2D/3D-Gittern gebracht (vgl. Cauchy-Stress Tensor), haben aber auch andere praktische Bedeutungen in der Physik.
Mithilfe von globalen Beleuchtungsmodellen/-techniken wird eine neue Methode entwickelt, um Tensorfelder zu visualisieren, die aber zusätzlich auch verwendet werden kann um die Lichtausbreitung in einer topologischen Szene zu beschreiben. Als Grundlage leiten wir ein einfaches Lichtausbreitungsschema für kartesische Gitter ab, dass die Prinzipien der Ausbreitungsdämpfung und Energieerhaltung beachtet und Licht-verteilung/en für gegebene Lichtquellenrichtung/en und -positionen bis zur Konvergenz approximieren kann. Als unterliegendes Modell werden die Transmissionsprofile innerhalb diesem Gitter als Kristallfiberstruktur angenommen (vgl. Edelsteine: Katzenaugeneffekt beim Tigerauge). Die folgende Aufgabe ist es, anisotrope Fiberstrukturen mit der Orientierung und den Anisotropiemaßen des unterliegenden Tensorfelds zu modellieren. Dafür erstellen wir per Hauptachsentransformation (PCA) ein Eigensystem für jede Zelle des Tensorfelds und modellieren eine zugehörige Ellipsengleichung als (Transfer-/Wichtungs-) Transmissionsprofil. Folglich kann die resultierende Lichtverteilung als 2D Skalarfeld oder Polarplots für Richtungsinformation visualisiert/repräsentiert werden. Wir messen Impulsantworten des Tensorfelds mit Delta-Pulsen an jeder Position und in jede Richtung um eine uniform gesamplete Map der globalen Lichtverteilungen zu erhalten. Diese Map wird als ein globales Energieflussfeld betrachtet. Wir lassen uns von der Technik FTLE aus dem Bereich Particle Tracing der Vector Field Visualization inspirieren, indem wir den Gradient des Flussfelds der resultierenden Lichtverteilungen analysieren und visualisieren. Ähnlich wie FTLE in Vektorfeldern Gräte/Kämme/LCS detektiert, erfasst unsere Methode dieselben Strukturen, anziehende/abstoßende/sattelnde Tensorfeldlinien die häufig Schlüsselstrukturen in der Natur repräsentieren, in Tensorfeldern. Wir führen diese Größe als Global Illumination Gradient ein, der einen FTLE-verwandten Ansatz darstellt, um LCS in Tensorfeldern durch die Analyse des globalen, durch einen Imprint (Gravur in kristallinen Fiberstrukturen) gerichteten Lichtflusses, zu visualisieren.
\newpage

\chapter*{Abstract}
%\input{abstract}
Many problems in science and engineering require
tensor field representations. Tensor fields, are most commonly associated with stress distributions (cf. Cauchy-stress tensor) in 2D/3D grids, but also have some other meanings in practice in physics. By means of global illumination techniques, we motivate a new method to visualize tensor fields, which is also capable of visualizing the light transport (propagation) in a topologically defined scene geometry. As a basis, we derive a simple light propagation scheme for Cartesian grids, which satisfies propagation attenuation and energy-conservation principles and is able to approximate light distributions for given light source position(s) and direction(s) until convergence. The transmission profiles within this grid are considered as crystal fiber structures as an underlying physical model (, eg., gemstones: tiger's eye's cat's eye effect). The consequent task is to model anisotropic fibre structures with the orientation and anisotropy measures of the underlying tensor field in the grid.
For this, we derive an eigenbasis by PCA (principal component analysis) for every cell of the tensor field and form an ellipsoid equation as transmission (transfer/weighting) function for the transmitted light profiles. Hence, the resulting light distribution can be visualized via 2D scalar field color coding or polar plots for directional information. Additionally, we measure impulse responses of the tensor field with Dirac-pulses as light sources at any (sampled) position and in any direction to generate a uniform sampled map of the global illumination distributions. This map is considered as a global illumination energy flow field.
We gain inspiration by vector field particle tracing's FTLE approach for analyzing the gradient of the flow field of the resulting light distributions. Similar to how the FTLE detects ridges/LCS (Lagrangian coherent structures) in vector fields (flow fields), our approach captures these structures likewise, namely attracting/repelling/saddling tensor field lines (TFL) which frequently represent key structures in nature, in tensor fields. We denote this entity a light transport gradient (LTG) which states an FTLE-related approach for visualizing LCS in tensor fields through analysis of the global light transport  directed by imprint/engraving in crystelline fiber structures modeled by the tensor field's ellipsoid glyhps. We evaluate our approaches for plausibility and comparability within an extensive test campaign and demonstrate its performance on several examples of datasets.
\newpage

% MAIN PART:
% Table of contents (Inhaltsverzeichnis)
\tableofcontents
\cleardoublepage
\pagenumbering{arabic} 

% List of figures (Abbildungsverzeichnis):
%\listoffigures
% List of tables (Tabellenverzeichnis):
%\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Here, the actual content of your thesis begins
% You can either put all the text here or use individual files to store the chapters of your thesis.
% Below are templates for both alternatives.

\chapter{Introduction}\label{intro}

In this work, we will discuss the advantages of tensor field analysis and motivate a new method for tensor field visualization through a coherent light transport visualization. At first, we will shortly state the problem setting, objectives and give a quick overview about the structure of this work. The main contributions of this work are listed in the bullet list below:

\paragraph{Contributions of this Work}
\begin{itemize}
	\item light transport method (progation scheme) following basic but crucial physical principles for tensor field visualization using tensors as transmission profiles
	\item visualization of the propagation results in $2D$ polar profiles
	\item a FTLE-related approach called light transport gradient (LTG) for visualizing key structures (ROIs) namely LCS in $2D$ second-order tensor fields
\end{itemize}
%Dieses Kapitel gibt einen Überblick über die Arbeit. Gerade der
%Abschnitt zur Motivation soll allgemein verständlich geschrieben
%werden. Die Einleitung sollte auch wichtige Referenzen enthalten. 

\section{Motivation}
\label{sect:motiv}
Tensor field visualization is gaining importance as a relevant tool for the analysis of fluid and solid mechanics, where tensor representations are crucially needed. This is always the case, when a directional distribution is needed for a single point in space. Tensors occur most commonly in medical, scientific and engineering applications, making them a frequently used mathematical entity in science. In general, a tensor is a $o$-D generalization of scalar, vector and matrix and appears, e.g., as Jacobian matrix (spatial gradient) in vector (flow) field visualization or as stress tensor in solid and fluid continuum mechanics. Basically, tensors describe compressions, tensions, rotations and volume changes in both solid and fluid material. While most techniques focus on symmetric tensor field visualization (like glyphs and tensor field lines), some other recent works adress the problem of asymmetric tensor field visualization. The issue with asymmetric (non-symmetric) or antisymmetric (skew-symmetric) tensors is, that they do not always yield real eigenvalues, which is needed to determine an eigenbasis to set up glyphs, hyperstreamlines or tensor field lines (classically). Nevertheless, there has been extensive work in this domain as well. Zheng \& Phang et al. \cite{pang&zheng} proposed the concept of dual eigenvectors and Lin et al. \cite{zhang} extended it to pseudo-eigenvectors and introduced eigenvector and eigenvalue manifold to visualize eigenvectors in the complex domain. In this work, we will use the $\mathbf{U}$-matrix obtained from singular value decomposition (SVD) to obtain the half-axes of the PCA principal ellipsoid representing the tensor transformation as suggested by Moler \cite{moler} to state another alternative of processing asymmetric tensors. 2D tensor field visualization is useful for cases where only two-dimensional data is available, such as satellite remote sensing data, Particle Imagery Velocimetry (PIV) data and earthquake data. Additionally, tensor field visualization aids geologists and medical scientists in their field of work to display complicated number arrays which seem almost impossible to interpret in their raw, unprocessed form. Nevertheless, comprehensive visualization is aiding scientists in their everyday lifes understanding complex data loads such as tensor fields. We can only try to invent new methods continuously evaluating them for suitability for certain domains of science to provide our techniques at best considering them for the right appilcations.\\


\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/DIFFERENT_TYPES_OF_STRESS.png}
  }
  \caption{Different types of stress}
  \captionsetup{font={footnotesize,bf,it}}
  \caption*{src: \url{https://upload.wikimedia.org/wikipedia/commons/e/eb/DIFFERENT_TYPES_OF_STRESS.png}}	
  \label{Skalierung}
\end{figure}


\section{Objectives}
\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/hyperstreamlines.png}
  }
  \caption{Hyperstreamlines in tensor field visualization}
  \captionsetup{font={footnotesize,bf,it}}
  \caption*{src: \url{http://www2.cs.uh.edu/~chengu/Teaching/Fall2018/Lecs/Lec17.pdf}}	
  \label{Skalierung}
\end{figure}
The main purpose of visualization in general is to reduce or encode some set of numbers in some readable, explorable and more intuitive representation. This implies, e.g., clustering, structuring or projection techniques. When it comes to tensor fields, this comes in handy in, e.g., medical sciences such as in DT-MRI (diffusion tensor-medical resonance imaging) \cite{hlawatsch} when measuring water molecule diffusion characteristics within tissue or in simulated (or measured) stress tensor fields from solid and fluid mechanics. In these domains of science the problem arises, that tensor fields can be generated (simulated) or measured with physical/mathematical background, but not be regarded intuitively. Necessity begets ingenuity as always, which lets visualization methods and systems emerge in this context. Concurrently, the problem setting of this work encomprises the visualization of tensor fields, i.e., mostly 2D/3D-grids consisting of mainly second-order tensors (cf. Cauchy stress tensor). These grids span a spatial domain in general with sample positions indicated by vertices. Tensor fields feature a sampling grid consistent of tensors which is usually spaced uniformly. A Cartesian grid, which we will utilize in this context, is a normalized regular grid. We aim to use global illumination methods to model light transport directed by tensor fields. Thus, the objective of this work is to design a simple light propagation scheme yet following the most basic but crucial physical principles and laws, like energy conservation and propagation attenuation for tensor field visualization. Additionally, it should hold the possibility to model light transport transport in a geometrical scene. This propagation scheme can either be used to visualize the light transport paths (defined by separatrices) in a scene defined by geometry concerning no influence of a tensor field. Or, on the other hand, be used to visualize the anisotropy characteristics of a given tensor field concerning the influence of one. However, the tensor field needs to be pre-processed somehow to generate a tensor induced footprint map of transmission profiles, which we will do via matrix decompositions. For this purpose, we will let the transmission profiles act on our simple yet realistic light propagation scheme to have a kind of tensor controlled directive effect on the light transport. The transmission profiles should modulate the outgoing intensities in a sense of redirection or redistribution. Of course, the propagation scheme will need some kind of stimulus which can be defined through symbolic functions by the user which we sample as a primary step. This way, the approach will operate as a global illumination visualization technique for light distributions in polar coordinates but the user must set an initial profile into the grid. In the sense of automization and optimzation, another consequent aim is to implement an approach borrowed from vector-field visualization to reveal structures, which are hard to graps by ordinary methods. We construct an FTLE-related approach in tensor field visualization (both symmetric and asymmetric) for detecting ridges/LCS (Lagrangian coherent structures). These structures can be classified (identified) as repelling, attracting and saddling (forming a saddle) local features, which frequently represent key structures in nature. LCS usually separate regions of different flow behavior, but in our case they separate regions/domains of varying directional distributions (manifesting in diverging/converging tensor field lines) represented by tensors as we use our tensor controlled light transport method to compute the FTLE field. Thus, we propose another method to compute an FTLE like field on tensor fields. The FTLE map responds most where tensor field lines / hyperstreamlines converge or diverge, whereas one is the same as the other because of bidirectional stress directions and since we effectively measure the finite-time Lyapunov exponent (FTLE) with both forward and backward integration time (stimulus directions, in our case), we will detect both cases. Both invented methods, will give new insights into the topology and anisotropy of tensor fields and provide tools for the structural analysis. The greater goal of this work is therefore the encoding of a tensor field into certain elaborate representations and the interpretation of meaningful results comparing the proposed techniques against others. The designed approach could e.g. be applied in medicinal sciences, engineering and physics to reveal structures which are hard to grasp through interpreting simpler and sometimes confusing glyph and tensor field line visualizations.


%In diesem Abschnitt sollen neben den Herausforderungen und der
%Problemstellung insbesondere die Ziele der Arbeit beschrieben werden. 

\section{Structure of this Work}
 
For the rest of this work, we will give a quick overview on the structure and outline. Next, in chap. \ref{chap:grundlagen}, we will capture important fundamentals like Tensors, polar coordinates, PCA and GT data in the context of singular value decomposition (generalization of eigenvalue decomposition). Also we will discuss the most relevant related work in the domain of tensor field visualization. In chap. \ref{chap:main}, we will propose the main contributions and methods of this work and document the results and evaluation in chap. \ref{chap:eval}. Subsequently, A compact Summary, Conclusion and Outlook will be given in chap. \ref{chap:concl}.\\

%Dieser Abschnitt wird meist recht kurz gehalten und beschreibt im
%Prinzip nur den Aufbau des Rests der Arbeit. Zum Beispiel: In Kapitel
%\ref{chap:grundlagen} geben wir einen Überblick über die  Grundlagen
%zu der Arbeit sowie über verwandte Arbeiten. In Kapitel
%\ref{chap:main} stellen wir dann \ldots vor. \ldots etc.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Fundamentals and Recent Work}
\label{chap:grundlagen}

In this chapter, we will capture the prerequisites necessary to understand the contributions of this work and we will capture tensor fields, polar coordinates, PCA, GT approaches and related work in that sense.

%Die ersten paar Abschnitte in diesem Kapitel führen in die Grundlagen
%zur Arbeit ein. Das können beispielsweise Grundlagen zu Netzwerken
%oder zur Informationsextraktion sein. 

\section{Tensor Fields}
\label{sec:tensors}
Now what is a tensor? A tensor is a $o$-dimensional generalization of a matrix as illustrated in Table \ref{tensor}.
\begin{table}[!b]
\centering
\caption{Tensor Shapes}
 \begin{tabular}{c|c|c|c|c|c|c}
\textbf{order} & 0 & 1 & 2 & 3 & ... & o \\ 
\hline 
\textbf{shape} & scalar & vector & matrix & ``3D matrix'' & ... & $\mathop{o}$D matrix\\ 
\end{tabular}
\label{tensor}
 \end{table} 
In addition to that, a tensor has as many indices as its order $o$ and their run length is as long as its embedded dimension $n$ in space (the dimension of the row and column vectors), which is equal to the rank of the tensor for full rank (in other words the number of elements n for a $n{\times}n$-matrix). Tensors follow certain transformation rules which are defined for covariant/contravariant tensors. They are most commonly obtained and defined from mathematical transformation equations. Hence, any $oD$ number array could be a tensor, but the definition holds only if the transformation rules apply to these $oD$ number arrays (in a sense of mathematical/formal interpretation). This is mostly true for component indexed $oD$ number entities following matrix multiplication and transformation rules found in physics and math manifesting in calculation rules like matrix multiplication. Thus, a tensor in general is a $o$D number array arranged in meaningful order to put it simple. In fact, tensors themselves are interpreted as transformations which reflect an incoming direction vector (measuring, e.g., the stress in that direction) to an outgoing (stress) vector. To be a bit more concrete, tensors represent stress distributions in solids and fluids describing strain and flow features as these entities are not simple numbers or vectors. They occur in form of a tensor fields, and thus as entities or quantities in physics. That is, at each point (typically a Euclidean space or manifold) in space (indexed by the grid) there is a whole distribution of directions, e.g., stresses (elastic and viscous) which needs to be characterized and represented by a single tensor each. A tensor is considered non-degenerate if all eigenvalues $\lambda_i>\lambda_{i+1}$ manifesting in significant anisotropy.
 \\
 \paragraph{stress tensor}
 \begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.6\textwidth]
    {img/stress_tensor.png}
  }
  \caption{Cauchy stress Tensor}
  \captionsetup{font={footnotesize,bf,it}}
  \caption*{src: \url{https://en.wikipedia.org/wiki/Cauchy_stress_tensor\#/media/File:Components_stress_tensor_cartesian.svg}}
  \label{cauchy}
\end{figure}

The Cauchy stress tensor, which is propably the classical example of a tensor, is depicted in Fig. \ref{cauchy} and consists of 3 stress vectors $\mathbf{T(e_i)}$ arranged in row-major order. It appears in similar form as viscous stress tensor in fluid mechanics:
\begin{align*}
\boldsymbol{\sigma}
 = \left[{\begin{matrix} \mathbf{T}^{(\mathbf{e}_1)} \\
\boldsymbol{T}^{(\mathbf{e}_2)} \\
\boldsymbol{T}^{(\mathbf{e}_3)} \\
\end{matrix}}\right] =
\left[{\begin{matrix}
\sigma _{xx} & \sigma _{xy} & \sigma _{xz} \\
\sigma _{yx} & \sigma _{yy} & \sigma _{yz} \\
\sigma _{zx} & \sigma _{zy} & \sigma _{zz} \\
\end{matrix}}\right]  = \left[{\begin{matrix}
\sigma _x & \tau _{xy} & \tau _{xz} \\
\tau _{yx} & \sigma _y & \tau _{yz} \\
\tau _{zx} & \tau _{zy} & \sigma _z \\
\end{matrix}}\right] =
\begin{bmatrix}
\sigma _{11} & \sigma _{12} & \sigma _{13} \\
\sigma _{21} & \sigma _{22} & \sigma _{23} \\
\sigma _{31} & \sigma _{32} & \sigma _{33} 
\end{bmatrix}.
\end{align*}
These 3 stress vectors represent the orientation and magnitude of total resulting stress at plane ${x,y,z}$ in direction ${x,y,z}$ ($3^2=9$ individual numbers). Thus, the stress tensor poses a full valid represenation of the stress distribution at any point in space. The stress tensor itself can be interpreted as a transformation which maps an incoming normal direction vector $\mathbf{n}$ a resulting stress vector $\mathbf{T^{(n)}} = \mathbf{n}\cdot\boldsymbol{\sigma}$. The stresses in normal directions (diagonal elements) are directly related to the pressure, which is always isotropic and hence non-directionally dependent (kind of a Euclidean distance of the stress components). The tensor itself is a complicated representation and needs to be projected onto its principal axes to lower its dimensionality. It is possible to find 2 principal stress directions in 2D through PCA (see sect. \ref{sec:pca} below), for which there are no shear stresses existent in equilibrium. These form the principal directions of deformation at a certain location and are sufficient to describe the resulting transformation/deformation behaviour. The resulting system of principal directions and absolute stresses is often called an ``eigensystem'' or ``eigenframe''. So to say, an eigensystem, consistent of the principal directions/axes, spans a principal ellipsoid depicted in Fig. \ref{HAT} in sect. \ref{sec:pca}.
Another interpretation for the principal component ellipsoid is that it is the result of the tensor transformation applied to the unit circle. It is therefore somehow representing the distortion of an absolutely isotropic object (unit circle) by whatever the affine tensor transformation effects (e.g. stretching, shearing, mirroring, scaling, rotating). Let us consider it as some lower dimensional, more intuitive representation of the tensor which we were left with in the first place. To put it all together, a tensor is a mathematical transformation which is encoded inside of an abstract $oD$ number array, which comes in need, whenever we have a whole distribution of directions manifesting itself in a transformation ellipsoid.

\section{Polar Coordinates}
\label{sec:polar}
\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/polarkoordinaten.png}
  }
  \caption{polar space}
  \captionsetup{font={footnotesize,bf,it}}
   \caption*{src: \url{https://de.wikipedia.org/wiki/Datei:Ebene_polarkoordinaten.PNG}}
  \label{polar}
\end{figure}\vskip 3pt
Mathematically speaking, a polar space is a system which maps each angle $\phi$ a magnitude $r(\phi)$ through a symbolic function. The conversion formula from polar (given a radius $r$ and angle $\phi$) to Cartesian coordinates is depicted in Fig. \ref{polar} and is given by:
\begin{align*}
	x &= r \cos \phi, \\
 	y &= r \sin \phi.
\end{align*}
The inverse direction (given coordinates $x,y$) is a bit more complicated:
\begin{align*}
	r &= \sqrt{x^2 + y^2} \\
\phi &= \operatorname{atan2}(y, x)
\end{align*}
The polar domain is a circular axis version of the domain $[0..2\pi]$, with negative magnitudes in $r$ shifted by 180 degrees (point reflected) as this is the formal behaviour defined and required by the conversion formulas.

\section{Principal Component Analysis}
\label{sec:pca}
Note that we denote a matrix with a second order tensor interchangeably for the sake of simplicity in the following. Also keep in mind, that we interpret a matrix or tensor as affine transformation. For any state of stress in equilibrium it is possible to find $n$ (dimensionality) independent orthogonal directions with no shear stresses existent. Along these directions the principal stresses, which are normal (tensile/compressive) stresses, are exerted. The anisotropy can be represented by, e.g., ellipsoid glyphs.

\begin{figure}[!t]
\hskip 22pt
  \begin{minipage}[!t]{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/HAT.png}
    \label{HAT}
   \caption{2D principal component ellipsoid\/ glyph (eigenframe)}
   \captionsetup{font={footnotesize,bf,it}}
   \caption*{src: \url{https://de.wikipedia.org/wiki/Datei:HAT-ellipse0.svg}}
  \end{minipage} \hskip 40pt
  %\raggedright
  \begin{minipage}[!t]{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/glyphs.png}
    \caption{3D ellipsoid glyphs w. anisotropy coefficient (l:linear, p:planar, s:spherical)}
    \label{3Dglyphs}
    \captionsetup{font={footnotesize,bf,it}}
   \caption*{src: \url{https://slideplayer.com/slide/5291764/}}
  \end{minipage}
\label{gradient}
\end{figure}

Principal Component Analysis is an algorithm which can capture the principal components (directions) in stochastic data. But it works similarly on transformations to capture the principal directions from transformations like rotation and scaling. Now, principal component analysis can be done by eigenvalue or singular vector decomposition, whereas the former yields complex eigenvalues for asymmetric matrices. For (skew-) symmetric (normal) matrices, they are connected through the following relation: $s_i = \sqrt{|\lambda_i|}$ (cf. \cite{kieburg}). Note, that the eigenvectors match the singular vectors only for symmetric matrices, which does not mean that they do not form the half-axes of the principal component ellipsoid in other cases. Mathematically speaking, a decomposition is somehow decomposing a transformation (which follows certain transformation rules) into parts of subsequent transformations consistent of rotation and scaling ($\mathbf{A} = \mathbf{R}\mathbf{S}\mathbf{R}^*$). We choose to use singular value decomposition ($\mathbf{A} = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^*$) to be able to set up real eigenvalues for any kind of matrix (singular values are always real and positive). Also, the singular vectors of the $\mathbf{U}$-matrix represent the half-axes of the principal ellipsoid (eigenframe) shown in Fig. \ref{HAT} for any kind of transformation matrix as pointed out by Moler \cite{moler}. The singular value decomposition is defined as follows:
\begin{align*}
	\mathbf{A} = \mathbf{U} \boldsymbol{\Sigma} \mathbf{V}
\end{align*}
where
\begin{itemize}
	\item $\mathbf{U}$ is an $m × m$ unitary matrix
	\item $\boldsymbol{\Sigma}$ is a diagonal matrix {$m × n$} with positive real numbers on the diagonal
	\item $\mathbf{V}$ is an {$n × n$} unitary matrix, $\mathbf{V}^*$ is its conjugate transpose
\end{itemize}
 

 In addition, we also calculate the eigenvalues to exploit the sign of the real part of the eigenvalues (\cite{mroz}) ordered decreasingly by absolute value (corresponding to singular value order). The sign corresponds to tensile ($+$) and compressive ($-$) stress, which would allow us to visualize deformation glyphs with arrows pointing inwards for compressive and outwards for tensile stresses. We do this decomposition analysis once for each matrix and then store the precomputed results in a grid. The principal ellipsoid is also used as a transmission profile for the propagation scheme in symbolic form in a subequent step, which makes it a basic and central concept within the scope of this work. In this work, we will use the singular vectors yielded from singular value decomposition to avoid complex values yielded from eigenvalue decomposition. This will allow us to set up glyphs representing the major/minor axis of the underlying transformation for every kind of (asymmetric/symmetric) tensor. We will then use global-illumination techniques on top to generate a light transport flow map, which permits us somehow to forward the intensities which are given as pre-defined initialization values in form of symbolic functions defined by the user. This kind of light transport propagation scheme will also allow us to compute an FTLE-like field on the tensor fields.


\section{GT data / Approaches}
\label{sec:gt}
\paragraph{Glyphs and tensor field lines}
\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.5\textwidth]
    {img/tensorfieldlines.png}
  }
  \caption{tensor field lines: bold lines; ellipsoids: ellipsoid glyphs}
  \label{scheme}
\end{figure}\vskip 3pt
Glyphs are derived as a basis for the weighting profiles of the tensors in the following propagation scheme. They were chosen because it is an easy-to-use (understand) concept which can also be interpreted nicely. In fact, these reps are used for the principal component analysis of direction vectors for the tensor field line extrapolation (integration) in a subsequent step.
Tensor Field Lines (the type of tensor stream line - hyperstreamline analog that does not introduce artificial intertia) were implemented for Ground Truth (GT) data generation purposes. For example, when we design an FTLE-like field computation approach, we will need to know when tensor field lines diverge/converge.

\paragraph{Test Data (Generation)}
We used python's numpy library to generate pre-defined test cases and caught one real data example from \url{TensorVis.org}, which needed to be pre-processed through slicing and subsequent cropping to 2D samples ($2\times2$) matrices), which can be grouped into symmetric and asymmetric ones:\\

\begin{figure}[!t]
\centering
  \begin{minipage}{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/corner-TFL.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/spiral-TFL.png}
    \label{b)}
  \end{minipage}
  \begin{minipage}{0.3\textwidth}
    \includegraphics[width=\textwidth]{img/drain_old.png}
    \label{b)}
  \end{minipage}
\caption{a) ``corner''-Testfield, b) ``spiral''-Tesfield, c) ``V''-Tesfield}
\label{anisotropy}
\end{figure}

\textbf{Symmteric Tensor Fields}

\textbf{Asymmetric Tensor Fields}

\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/drain.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/drain-TFL.png}
    \label{b)}
  \end{minipage}
\caption{a) ``drain''-testfield, b) tensor field lines for a)}
\label{drain}
\end{figure}

The ``drain''-Testfield, depicted in Fig. \ref{drain} is generated to have a kind of proof-of-concept (POC) for the FTLE-related approach. It poses raw, bare diverging tensor field lines without any other feature modulated on top. Thus, it can be expected to induce a high FTLE response, since it is an interpretable ground truth test and is considered to be a basic trigger/stimulus for the approach.

\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/rings.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/tensorfieldlines.png}
    \label{b)}
  \end{minipage}
\caption{a) ``rings'' test field, b) tensor field lines for a)}
\label{rings}
\end{figure}
The ``rings'' test field, depicted in Fig. \ref{rings} should be used to demonstrate the directive ability of the approach transmitting energy in circular orbits.
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/spiral.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/spiral-TFL.png}
    \label{b)}
  \end{minipage}
\caption{a) ``spiral''-testfield, b) tensor field lines for a)}
\label{spiral}
\end{figure}
The ``spiral'' test field, depicted in Fig. \ref{spiral} should be used to demonstrate the directive ability of the approach transmitting energy in archimedian spiral orbits.
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/inverse.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/inverse-TFL.png}
    \label{b)}
  \end{minipage}
\caption{a) ``inverse''-testfield, b) tensor field lines for a)}
\label{inverse}
\end{figure}
With this test field we want to demonstrate the directive separation of intensities into four quadrants.


\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/corner.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/corner-TFL.png}
    \label{b)}
  \end{minipage}
\caption{a) ``corner''-testfield, b) tensor field lines for a)}
\label{corner}
\end{figure}
The test field ``corner'' poses a sustained turn over the grid representing the redirection or forwarding along domain corners.

\section{Related Work}
\label{sec:related}

There has been extensive recent work on symmetric tensors but in comparison little on asymmetric ones. Since we aren't able to cover the whole scope in this work, we will focus on the most relevant works on tensor field visualization. We will talk about the publications from Hlawatsch et al. \cite{hlawatsch} and Zirr et al. \cite{zirr} in particular, since they pose thematically close related works.\vskip 5pt

\textbf{Symmetric Tensor Field Visualization}\\
Zheng \& and Pang \cite{pang&zheng} et al. proposed a texture-based visualization approach called Hyper LIC, which extends the concept of LIC to symmetric tensor fields by using an anisotropic 2D-filter kernel oriented along the major/minor eigenvectors. The concept of following the major/minor eigenvector along tensor field lines was invented by Vilanova et al. \cite{vilanova}. Tensorlines \cite{weinstein} introduce a kind of artificial inertia (running average), making them resistent to noise. The notion of tensor field topology (critical, degenerate points, separatrices) and the concept of Hyperstreamlines was first introduced by Delmarcelle and Hesselink \cite{delmarcelle&hesselink}. The topology in $3D$ tensor fields was first analyzed by \cite{zheng}. The placement of tensor field lines as hyperstreamlines was recently improved by Spencer et al. \cite{spencer} for glyph packing. A good overview of seeding strategies concerning glyphs is given by McLoughlin et al. \cite{mcloughlin}. Feng et al. \cite{feng} used Voronoi Tesselation for placing the glyphs. Superquadric glyphs have been proposed by Schultz and Kindlmann \cite{schultz&kindlmann} for general (non-positive definite) tensors. De Leeuw and van Wijk \cite{deleeuw&vanwijk} visualize the partial derivative gradient, the Jacobian of the tensor field to sense the local properties of the field. A diffusion tensor can also be visualized by box \cite{makris}, ellipsoid \cite{pierpaoli}, composite \cite{westin2} or superquadric \cite{kindlmann} glyphs. There is also a set of scalar measures available in symmetric tensor field visualization such as: mean diffusivity, fractional anisotropy \cite{basser} and anisotropy coefficients \cite{westin}. These coefficients can also be visualized by direct volume rendering \cite{kindlmann2}. Hlawatsch et al. \cite{hlawatsch} obtain a coordinate (flow) map from tensor field lines following major/minor eigenvectors (fibre trajectories) and use the maximum eigenvalue of the Cauchy-Green deformation tensor to compute the FTLE-field in homogeneous regions. In a similar manner, we aim to use light transport techniques to obtain a final light distribution through successive light propagation cycles footprinted (in form of transmission profiles obtained from ellipsoid glyphs) by the tensor field. DT-MRI diffusion tensor imaging can help to reveal the functional \cite{denis} or topological \cite{wakana} structure of the brain and muscles by analysing celebral and muscle tissue tractography which yields a tensor field of the anisotropy of the brain's white matter. An overview about DT-MRI visualization techniques is given by \cite{vilanova}. Tricoche et al. \cite{xavier} use invariant manifolds to extract topological features from tensor fields. Other, feature extraction based approaches extract general features as: edges \cite{hancock}, tensor shape\/ orientation \cite{gordon}, interfaces \cite{donnel}, creases \cite{tricochet}.
\\
\textbf{Asymmetric Tensor Field Visualization}\\
Zheng and Pang \cite{pang&zheng} proposed the concept of dual eigenvectors and Zhang et al. \cite{zhang} extended it to pseudo-eigenvectors and introduced the eigenvector/eigenvalue manifolds to visualize eigenvectors in the complex domain. Laramee et al. \cite{laramee} focused on the efficient implementation and visualization of these structures and provided an interactive visualization system for asymmetric tensors applicable in fluid and solid dynamics. The concept of tensor magnitude has been introduced by \cite{laramee} for means of physical interpretation. They also proposed an efficient glyph and hyperstreamline hybrid approach, which made dynamic interaction in real-time in 2D tensor fields feasible. Palacios et al. \cite{palacios} extracted isosurfaces of tensor magnitude, mode and isotropy index. \vskip 5pt

Last, we will discuss our work in relation to other publications. While these previously mentioned works use classical approaches like tensor field lines and glyphs, we will also introduce the concept of Lagrangian coherent structures into our framework contribution of tensor field analysis. LCS have been defined as time-dependent analog of separatrices \cite{haller} which are concerned to be robust under noisy conditions \cite{haller2}. The work of \cite{hlawatsch} et al. obtains similar results (an FTLE-like field) but obtains them by sampling of fiber trajectories instead of global illumination light transport methods, as in our case. Our work shares the same basic idea, deriving and computing a FTLE field for tensor field visualization generalizing FTLE from vectors to tensors, yet using a light propagation scheme and hence use whole distributions of trajectories employing polar profiles. We will detect LCS with an FTLE-derived method considering final light transport distributions. The FTLE-related approach named ``light transport gradient'' to be designed states a generalization of the light transport visualization method FTPD proposed by Zirr et al. \cite{zirr}, since it allows a similar measure to be computed through defining a geometrical scene and setting the transmission (tensor field) to an isotropic and constant value of $100\%$. In this operating mode, the approach operates as a light transport visualization technique neglecting any tensor field transmission profiles. 
%Typischerweise im letzten Abschnitt dieses Kapitels wird dann auf
%verwandte Arbeiten eingegangen. Entsprechende Arbeiten sind geeignet
%zu zitieren. Beispiel: Die wurde erstmalig in den Arbeiten von Spitz
%und Gertz \cite{Spitz2016a} gezeigt \ldots Details dazu werden in
%dem Buch von Newman zu Netzwerken \cite{Newman2010} erläutert \ldots.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

% Alternative: put content in separate files
% Check the difference between including these files using \input{filename} and \include{filename} and see which one you like better
%\chapter{Einleitung}\label{intro}
%\input{introduction}
%
%\chapter{Voraussetzungen}\label{bg}
%\input{background}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

\chapter{Method}
\label{chap:main}

This chapter will summarize the main contributions of this work studied and state targeted aims and goals as a first step in sect. \ref{sec:overview}. Then we will have a short introduction to the implemented global illumination scheme derived and simplified from an nVidia global illumination approach in sect. \ref{sec:scheme}. Last, we will state the effectively implemented Visualization methods Light Transport Visualization and Global Illumination gradient proposed as innovatively invented tensor visualization techniques.



%Dieses Kapitel stellt meist den Hauptteil der Arbeit dar. Vor dem
%ersten Abschnitt sollte ein kurzer Überblick (ein paar wenige Sätze
%mit Verweise auf nachfolgende Abschnitte) gegeben werden. Beispiel: Im
%nachfolgenden Abschnitt \ref{sec:overview} wir ein Überblick über die Anforderungen an
%das Modell gegeben. 

\section{Requirements and Ambitions}
\label{sec:spec} 
Our ambition is to motivate a simple and efficient global illumination propagation scheme able to distribute energy profiles in discrete polar form in 2D/3D-space w.r.t. energy conservation and propagation attenuation principles. We then generate transmission profiles from the eigensystems (principal component frames) of the tensors for each cell in the domain (field). This step is done, to provide an orientation for a grid of crystal fibre structures (cf. optical fibres) to redirect the intensities in analogy to the anisotropies of the tensor field within a glyph representation, obtained from Principal Component Analysis. Our approach should be implicitly adaptive to any kind of 2D dataset or slices of 3D datasets. Thus, we require to be compatible to handle any kind of matrix (symm./anti-symm.) and any kind of resolution of the field (full-spectrum). At last, our ambition is to segment key locations (LCS/ridges) in the field with tensor field lines (hyperstreamlines) converging/diverging, which is necessarily the same (for bidirectional eigenvectors of tensors). Thus, we aim to generate a new FTLE-related method for tensor field visualization by applying a light transport gradient to the resulting light distributions for every possible position and direction of the light source in the grid generated by stimulation with Delta-pulses. Our approach should efficiently handle (relatively) large datasets with reasonable resolutions. 
%Knapp zwei Seiten, in dem die Anforderungen, die Zielsetzung und die
%Methoden überblicksartig beschrieben werden. Hier sollte die
%Beschreibung ``technischer'' bzw.~``formaler'' sein als in der
%Einleitung, da der Leser nun mit den Grundlagen und verwandten
%Arbeiten vertraut ist.

\section{Light Transport (Propagation) Scheme}
\label{sec:scheme}
Within the scope of this work, we will motivate a light transport propagation scheme designed to efficiently propagate initial intensity profiles stored in polar coordinates given as symbolic impulses (stimuli) by the user or the config. This polar profiles are first sampled into a vector with elements ranging over the interval $[0,2\pi]$. Polar profiles for different light sources are shown in Fig. \ref{polar}:
\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/strahler.png}
  }
  \caption{Polar profiles for different types of emitters ($m=0$: spherical emitter, $m=1$: Lambert emitter, $m=2$: cone emitter}
  \captionsetup{font={footnotesize,bf,it}}
  \caption*{src: \url{http://www.optik.uni-erlangen.de/odem/vorlesung/ws1213/Photometrie_Geometrische_Optik.pdf}}
  \label{polar}
\end{figure}\vskip 3pt
As a reminder, polar profiles map each angle $\varphi$ a magnitude $r$ forming a function $r(\varphi)$. They are circular axis versions of the domain $[0..2\pi]$, with negative magnitudes point reflected by 180 degrees. Thus, they are functions with an angular domain making them directionally dependent, which is a well suited representation for point lights, as we use them in a style of Dachsbacher et al. \cite{dachsbacher}. For the sake of interpretability, we exclude negative values (energies) from the scope of our calculations which we express through mathematical clip functions, limiting negative values to $0.0$, which we denote by subscript $+$ in the following. As a start-up thinker for the propagation scheme, we will think of a grid cell in 2D as a center pixel within an 8-neighborhood. Remember, that all considerations from now on are given concerning a single grid cell respectively. It has 8 (4 faces/edges and 4 diagonals) unique neighbors, which are adjacent point lights in the grid (the type of light source with theoretically no finite extend). We consider one face neighbor (top) to shortly explain the steps of the scheme. The diagonals and the others are obtained from derivation and symmetry.

Each cone (yellow and green) is an individual neighbor-dependent angular area. The diagonals take in a greater angular domain while they are located at greater distance and thus need to be attenuated more strongly (consider an isotropic stimulus). We aim for distributing contributions for overlapping cones to transmit attenuated (because of the larger factor $\sqrt{2}$ distance) intensity in form of a shared part to the diagonals in a single step (which also prevents from zigzagging diagonal intensities in case we would transmit diagonal intensities around the corner). Therefore, the intensity gathered in polar coordinates in areas marked in green, needs to be partitioned between 2 of the 8 cone index neighbors with following considerations:

\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.8\textwidth]
    {img/geogebra-export_large.pdf}
  }
  \caption{Propagation Scheme}
  \label{scheme}
\end{figure}\vskip 3pt

The face neighbors take in the angular domain of $d_1=\alpha+2\beta$ (yellow cone), whereas the diagonal neighbors (green cones) span a domain of $d_2=2\beta$.
The linear combination weights for the overlapping (green) parts ($\beta$) are obtained from the relative overlapping angular area of the angular span $\beta$ w.r.t. diagonal cones ($2\beta$) and yellow face cones ($\alpha+2\beta = 90^\circ$) (yellow cone is overlapped by green cones at full angle). The linear combination weights are subsequently normalized to $\sum = 1.0$ (normalization condition):
\begin{align}
	\varepsilon_1 &= \frac{\frac{\beta}{\alpha+2\beta}}{\frac{\beta}{\alpha+2\beta} + \frac{\beta}{2\beta}} \approx 0.362291\\
	\varepsilon_2 &= \frac{\frac{\beta}{2\beta}}{\frac{\beta}{\alpha+2\beta} + \frac{\beta}{2\beta}} \approx 0.63771.
\end{align}

Remark, that we can precompute these linear combination weights and reutilize them in each iteration. We define the contributions as follows:
\begin{align}
	\Phi_{\alpha} &= \varepsilon_1(\int_{-\pi/4}^{-\beta}{I}(\omega)\mathop{d\omega}+\int_{\beta}^{\pi/4}{I}(\omega)\mathop{d\omega})+\int_{-\alpha/2}^{\alpha/2}{I}(\omega)\mathop{d\omega}\\
	\Phi_{\beta} &= \varepsilon_2\int_{-\beta}^{\beta}{I}(\omega)\mathop{d\omega}
\end{align}

 We place a cosine lobe scaled with the integrated (accumulated) energies in each of the 8 cone directions (angular domains), whereas outgoing integrated and summed energies are weighted by the linear combination weights (factors) in overlapping (green) areas to split up the contributions accordingly. The contribution areas are depicted in Fig. \ref{scheme}, the cosine lobes can be observed in Fig. \ref{iter} respectively. This manner of propagation is inspired by the propagation scheme of Dachsbacher et al. \cite{dachsbacher} (see the paper on how to ``project the flux into a point light''). Basically, we sum up the weighted intensities corresponding to the respective neighbor and scale an oriented cosine lobe (in direction of the neighbor) with the total flux $\Phi_t$ accumulated inside the neighbor range to transmit all of the parsed intensity for each neighbor for each cell. The implementation is done in a dual buffer approach which pushes the energies back and forth (buffer A to buffer B) until convergence, which happens when the energy is spreaded throughout the grid and enters a stationary state of equilibrium, characterized by equal out (at grid borders) to in (at light source positions) energy-flow with no more nettings going on inside the domain. We measure the convergence by setting up an overall distribution error w.r.t to the previous iteration. Note that even though we propagate the energy directly through the diagonal cones (which forms a square initially), the 8 degrees of freedom introduce a circular (spherical) wave front after few iterations (for greater resolutions) as depicted in Fig. \ref{iter}. This occurs, since the shared part effects a uniformly isotropic propagation profile by default and there is a redistribution of intensities in the long term resulting in a circular torus-shaped distribution, as also observed in Fig. \ref{iter}. Also note, that this approach satisfies energy conservation and propagation attenuation principles and applies to the principles of light propagation in vacuum (by default). The verification of these principal requirements and specifications can be observed in the evaluation in chap. \ref{chap:eval}. We first show the approach for a few iterations with a manual stop criterion to have a kind of imagination for the propagation process:

\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=1.0\textwidth]
    {img/steps_gallery_format_arrow_alt.png}
  }
  \caption{Impulse response for isotropic stimulus (few iterations: $t$)}
  \label{iter}
\end{figure}\vskip 3pt
Fig \ref{iter} depicts the named iteration inidices 0,1,2,3,7,11 for the propagation scheme for a circular pulse stimulus which gets turned off after 1 iteration to demonstrate raw energy spreading in the field (impulse response of the algorithm). In step 1 one can observe the placing of cosine lobes scaled with the respective accumulated and weighted energy for the summed area in each of the 8 neighbor directions. In the subsequent steps, remark the evolution from an 8-neighborhood in step 1 to a circular shaped torus.

As already mentioned, a dual-buffer approach is chosen here, as we can efficiently propagate from one into the other and just swap pointers to 
start all over (after reinitialization) until convergence. Another reason is it yields a reasonable source-target or read-write segmentation. We introduce a new operator called \textit{propagate}, permitting us to pre-define the propagation in a symbolic manner. The propagation definition denotes the transformation from one grid (A-buffer) into another (B-buffer) through proper application of the \textit{propagate}-operator to each cell. We will extend this operator with a normalization correction in sect. \ref{sec:trans} in form of a precise mathematical formulation respectively. For now, just imagine the approach in raw operating mode, with no tensor influence incorporated. That is, evaluating and accumulating the polar profiles, weighting with the linear combination weights and scaling and placing of a cosine lobe to the respective neighbor. For now, we want to define our operator $\mathop{propagate}$: Each Grid or Buffer is basically a set of cells defined as $\mathcal{C} = \{\mathbf{c}_1, \mathbf{c}_2, ..., \mathbf{c}_i\}$.  The dual buffer result $\mathcal{C'}$ is denoted symbolically as follows for all cells with a mean intensity greater than zero (which do not contain trivial null samples):
\begin{align}
	\mathcal{C'} = \mathop{propagate}\{c_i\in \mathcal{C} \ \mid \ |\mean{I}_i| > 0\} \hskip 5pt {\forall } \ i \in [1,\mathop{dim}].
\end{align}
where: $i$: cell index, $I$: source buffer radiant intensity\vskip 5pt
The dual buffer result $\mathcal{C'}$ denotes the set of all transformed cells after the propagation, i.e., after applying the operator $\mathop{propagate}$ to each cell. This result is generated once in each iteration and gets pushed back and forth between the 2 buffers. Note that, $\mathop{dim}=width\cdot height$, which equals the tensor field resolution in this case. At last, we define a threshold for the minimum overall distribution error for the total radiant flux taken into account for a convergence criterion, initiating a stop sequence when falling below that threshold $\epsilon$ (, e.g., $0.5$) :\\
\paragraph{Criterion:}
\begin{align*}
	\Delta \Phi_{total} &= \sum_{c_i\in\mathcal{C}}\mathop{abs}\Delta I_i(\omega) = \sum_{c_i\in\mathcal{C}} \int_0^{2\pi} \mathop{abs}(I'_i(\omega)-I_i(\omega)) \mathop{d} \omega  \overset{!}{<} \epsilon\\
\end{align*}
where $\phi_{total}$: total radiant flux, $I'$: target buffer radiant intensity\vskip 5pt
Note that we take the absolute value of the differences to prevent from mutual compensation.

Until now, we aimed to simulate the propagation of light in empty space (vacuum) providing us with a physically-motivated but very simplified base-approach. We aim to modulate the transmission of the intensities on top of the base approach with transmission profiles obtained from the tensor fields through principal component analysis, which yields ellipsoid glyph equations in the following.


%In diesem und den nachfolgenden Abschnitten werden die Beiträge der
%Arbeit motiviert, formal sauber (oft mathatisch, sprich mit
%Definitionen etc.) beschrieben, und bei Bedarf mithilfe von Beispielen
%verdeutlicht. Die Beschreibungen in diesem Kapitel sind meist
%unabhängig von einer konkreten Realisierung und Daten; diese werden im
%nachfolgenden Kapitel detailliert.

\section{Transmission Profiles and Weighting Functions}
\label{sec:trans}
Note that the following considerations are only given for the tensor profile operating mode with tensor influence incorporated. To obtain a kind of footprint of the tensor field, we set up ellipse equations for each glyph representation, obtained from applying PCA on each cell (tensor) in the grid. Concurrently, we extend our abstract mathematical operator \textit{propagate}, previously referenced in sect \ref{sec:ltg}, by a normalization strategy necessary for windowing weighting profiles, as it is the case for our elliptical transmission profiles, which we will capture in the following. At this point, we presume the precomputation of singular value decomposition and linear combination weights. We map the singular values (corresponding to eigenvalues $\lambda$ here for simplicity) in decreasing order to the ellipses radii (half-axes) $a(\lambda_1 )$ and $b(\lambda_2 )$ as follows:

Ellipse Equation:
\begin{align}
	r(\omega) = \frac{ab}{\sqrt{a^{2}\sin^{2}(\omega-\varphi)+b^{2}\cos^{2}(\omega-\varphi)}} =\frac{\lambda_1\lambda_2}{\sqrt{\lambda_1^2\sin^2(\omega-\varphi)+\lambda_2^2\cos^2(\omega-\varphi)}}.
\end{align}
That is, the singular values form the half-axes of the PCA ellipsoid, which yields us a symbolic definition for our transmission (transfer) function as weighting profiles which we can now evaluate as a parsing and accumulating step. We compute the offset angle $\varphi$ w.r.t. the x-axis by exploiting the $\mathop{atan2}$-function with 4-quadrant evaluation for the first singular vector (ordered decreasingly in value) because we scale the $x$-axis with the first singular value. As a preliminary preparation, this profile is precomputed (sampled) for all discrete angular steps for each cell (, e.g., $360$) and stored for reuitilization as it is the case for the previously mentioned linear combination weights as well. The weighting scheme which we apply is depicted in Fig. \ref{weighting}.
\begin{figure}[!t]
  \centering
  {
    \includegraphics[width=0.6\textwidth]
    {img/polarplot.pdf}
  }
  \caption{red: Intensity Profile, cyan: Transmission Profile (glyph Ellipsoid Eq.)}
  \label{weighting}
\end{figure}
We interpret the polar functions as discrete, sampled 1D vectors with a uniform angular resolution. That means, we can use element-wise multiplication for the 1D-vectors in red (Intensity Profile) and cyan (Transmission Profile) to obtain a windowed version of the intensity profile and perform the following integration step to accumulate the total radiant power (flux) as follows. Note that we model angular dependent radiant intensity ${I}(\omega) [\frac{W}{\mathop{rad}}]$ as an underlying physical entity, which is well suited for describing point light sources. As a side note, the physical quantity perceived as brightness by human eyes, is the radiance (luminance), which is yielded by relating radiant intensity to a finite sensitive area ($[\frac{W}{\mathop{rad}}/m^2]$). The primary definition for our total accumulated incident radiant flux (presuming that the cone is given in local coordinates - i.e. centered around the origin) is then denoted as:

\begin{align}
	\Phi_{t,\alpha} &= \int_{-\pi/4}^{\pi/4}{T}(\omega){I}(\omega)\mathop{d\omega}\\
	\Phi_{t,\beta} &= \int_{-\beta}^{\beta}{T}(\omega){I}(\omega)\mathop{d\omega}
\end{align}

This permits us to scale an oriented and clipped cosine-lobe $\cos_+$ with the total radiant flux w. respect to its own total energy when integrated likewise. A discrete cosine lobe never reaches its theoretical sum of $2$ exactly in the interval $[{-\frac{\pi}{2}},{\frac{\pi}{2}}]$. Therefore it needs to be computed to account for floating-point precision errors and normalized by following relation (, e.g., $\sum_{\cos} \approx 1.9949204635834517$).
\begin{align}
\sum_{\cos_+} &= \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\cos_+(\omega)\mathop{d\omega} \approx 2,\\
	\cos_n(\omega) &= \frac{\Phi_t}{\sum_{\cos_+}}cos(\omega).
\end{align}
This yields a cosine lobe, which has an overall energy of $\Phi_t$ if the point light is interpreted with a Lambert-emitter (cf. \cite{lindlein}) characteristic (as part or area element of a diffusely reflecting surface) since the intensity profile matches a cosine in this case. This emitter characteristic is the case for global illumination diffuse indirect lighting (non-specular). It is used in similar style by Dachsbacher et al. for propagating intensities through LPVs (light propagation volumes).
But hey we should not generate any exceeding energy right? Now each tensor ellipse equation has a mean transmission rate $[\%]$, which turns out to be a measure or synonym for the total rate of the outgoing transmitted radiant intensity $\int_0^{2\pi}{T}(\omega)\mathop{d\omega}$. Since energy can not be generated from transmission profiles (only transmitting, not generating), we have to normalize every tensor ellipse equation with the highest mean transmission rate in the field, which is then transmitting the whole outgoing intensity $\int_0^{2\pi}{I}(\omega)\mathop{d\omega}$ in total. This restricts the tensor ellipse mean to a maximum of $100\%$ for the tensor with the highest tensor magnitude. We will use the self-made definition of mean tensor magnitude $\mean{r}_{max}$ obtained from the PCA here for simplicity. Hence the tensor ellipse equations are normalized through the following step:
\begin{align}
	r_n(\omega) = \frac{1}{\mean{r}_{max}}r(\omega).
\end{align}
Notice, that this implements the concept of absorption implicitly, because tensors with a lower mean $\mean{r}$ than $100\%$ lose energy wheras absorption equals ${\mu} = {1}-{\mean{r}}$ here. Now that we have coped with the problem of overall transmission, we are left with another problem that occurs with the weighting functions as they can still yield values above $1.0$. Consider following examples as $T(\omega)I(\omega)$ pairs: $1.5\cdot 1.5=2.25$ and $0.5\cdot 0.5=0.25$, which disproves us that a mean $\bar{r}=1.0$ necessarily effects a mean transmission intensity $I_t$ of $1.0<1.25=\frac{2.5}{2}$. This would potentially generate intensity out of nothing which leads to crucially unstable behaviour. Well, but only in case energy conservation principles were not respected.  To construct a solution, we ask for the source of the excessive energy. If the tensor mean complies with the constraint $\mean{r}\leq 1.0$, then the energy must lack in some other place (since the overall transmission fulfills the energy conservation constraint in that case). The only problem is that a normalization condition in usual style for the transmission profile ${T}(\omega)$ does not necessarily imply the same normalization for the term ${T}(\omega){I}(\omega)$. However, a proper normalization can provide corrective support, wich reveals another subsequent normalization constraint. The normalization factor is defined in 3 subsequent steps:
\begin{enumerate}
	\item Normalization of $TI$ to $\overline{TI}=1.0$
	\item Subsequent scaling w. mean intensity $\mean{I}$ for energy conservation principles
	\item Subsequent scaling w. mean tensor magnitude $\mean{T}$ for absorption principles
\end{enumerate}

Hence the transmitted energy is given as:

\begin{align}
	{\Phi}_t(\omega) &= n_f{T}(\omega){I}(\omega) \hskip 30pt \mathop{w.} \ n_f = \frac{\mean{T}\mean{I}}{\overline{TI}}.
\end{align}

This transforms our equation for the radiant flux into:
\begin{align}
	\Phi_{t,i,\alpha} &= {I}_{t,i}(\omega) = n_f\int_{-\pi/4}^{\pi/4}{T}_i(\omega{I}_{i}(\omega))\mathop{d\omega}\\
	\Phi_{t,i,\beta} &= {I}_{t,i}(\omega) = n_f\int_{-\beta}^{\beta}{T}_i(\omega){I}_{i}(\omega)\mathop{d\omega}.
\end{align}
Which is now respecting energy conservation principles very conveniently, as all we need is a set of means and we are done. This collapses our abstract mathematical operator $\mathop{propagate}$, which is applied to each cell, into the following steps:
\begin{enumerate}
	\item Computation of normalization factor $n_f$
	\item Direction (component)-wise weighting to account for shared part in diagonal cones
	\item Integration (accumulation) total radiant flux weighted with \underline{normalized} transmission profiles inside the angular neighbor range (read-access)
	\item Scaling of cosine lobe corresponding to neighbor direction and subsequent placing to corresponding neighbor (write-access)
	
\end{enumerate}
Remember that this operator needs to applied once to each cell to form a whole propagation cycle propagating intensities from source to target buffer. This approach ensures that no energy will be generated and therefore implements the 	physical law of energy conservation or Kirchhoff's current law if you want to think of a particle's diffusion process. Consequently, this allows us to assume that all sources of power (energy) are user-defined. In fact the approach has proven to be robust w.r.t. energy losses for several iterations as depicted in chap. \ref{chap:eval} in the stochastic error graph.

\section{Physical Model}
\label{sec:model}
To pose a physical interpretation for the transmission of the tensor field, we imagine a melting crystal with  fibrous structures aligning with the major eigenvectors of the tensor field. This is what we call the footprint of the tensor field. In that sense of imagination, we would virtually imprint every tensor field into a crystalline structure as a preliminary initialization step. For an every day example, this can be observed in, e.g., the gemstone tiger's eye cat's eye effect, where crystal fibers align with the crystal axes respectively. The propability density function $P(\omega)$, for a photon being scattered in a particular direction $\omega$ \ref{ryder}, is then described as:
\begin{align}
 	P(\omega) &= \frac{T(\omega)}{\int_{k\pi}^{(k+1)\pi}T(\omega)\mathop{d\omega}}\\
 	w. \int_0^{2\pi} P(\omega) &= 1.
\end{align}
This propability density function (PDF) indicates whether there is directed anisotropy or spherical isotropy w.r.t the neighboring $180$ ($\pi \mathop{rad}$) degrees and how likely the spontaneuos scattering of a photon in this particular direction will happen. Each tensor is then a unique footprint which can be precomputed for convenience and described as polar profiles just as our previously mentioned intensity profiles. We apply these polar profiles in a sense of transmission profiles as discussed in sect. \ref{sec:trans}.

\section{Light Transport Gradient (LTG)}
\label{sec:ltg}
Remark that we denote the final buffer result $\mathbf{b}=\mathcal{C}_{final}$ in the following:

Now, that we are able to propagate intensity in grid, directed by the eigenvectors of the tensor field, we aim to do something more elaborate to segment ROIs (regions of interest) characterised by divergence/convergence of tensor field lines and drastic changes in anisotropy. As tensor field lines are bidirectional convergence and divergence can not reasonably discerned in that case. We opt to extract ridges from this FTLE-like field to grasp the key regions separating anisotropy behavior in the field segmented as height ridges in the field, which are in turn LCS (Lagrangian Coherent Structures) well known for their rich substance in physical meaning. They can even be observed in nature for, e.g., vortices in flow fields. For that, we will use our, previously defined, $\mathop{propagate}$-operator on every possible light source location $\mathbf{x}$ and direction $\omega$ in the grid to obtain the final set of buffers $\mathcal{B} = \{\mathcal{C}_1, \mathcal{C}_2, ..., \mathcal{C}_j\}$:
\begin{align}
	\mathcal{B} = \mathop{propagate}\{c_i\in \mathcal{C} \ \mid \ |\mean{I}_i| > 0\} \ {\forall } \ i \in [1,\mathop{dim}] \ {\forall } \ j \in [1,\mathop{dim}\cdot \mathop{steps}].
	\label{ftle}
\end{align}
Whereas $j$ is the index of light source position and direction representing the initialization in each iteration and $\mathop{steps}$ is the count of the discrete angular steps. The initialization is done by placing a light src (delta-impulse) with $\mean{I}_i = 1.0$ at the exact location of index $j$ realizing a light source at location $(x\mid y)$ in direction $\omega$. Eq. \ref{ftle} now denotes the set of buffers $\mathcal{B}$ containing light distributions propagated from every possible direction and location. Now, that we have measured impulse responses from every location in our long 1D sample vector, we can incorporate finite (central) differences to obtain the gradient of the set of final buffers with final light distributions as elements $\mathcal{C}_{final}=\mathbf{b}\in\mathcal{B}$:
\begin{align}
	\nabla \mathbf{b}_{x,y,\omega} =
	\begin{pmatrix}
	\frac{\partial \mathbf{b}_{x,y,\omega}}{\partial x} \\ \frac{\partial \mathbf{b}_{x,y,\omega}}{\partial y} \\ \frac{\partial \mathbf{b}_{x,y,\omega}}{\partial \omega}
	\end{pmatrix} \approx
	\frac{1}{2}
	\begin{pmatrix}
	\sum_{\mathbf{c}}\lvert \mathbf{b}_{x+1,y,\omega} - \mathbf{b}_{x-1,y,\omega}\rvert \\ \sum_{\mathbf{c}}\lvert \mathbf{b}_{x,y+1,\omega} - \mathbf{b}_{x,y-1,\omega}\rvert \\ \sum_{\mathbf{c}}\lvert \mathbf{b}_{x,y,\omega+1} - \mathbf{b}_{x,y,\omega-1}\rvert
	\end{pmatrix} =
	\frac{1}{2}
	\begin{pmatrix}
	\sum_{\mathbf{c}\in \mathbf{b_x}}\lvert \mathbf{b_x}\rvert \\ \sum_{\mathbf{c}\in \mathbf{b_y}}\lvert\mathbf{b_{y}}\rvert \\ \sum_{\mathbf{c}\in \mathbf{b_{\omega}}}\lvert \mathbf{b_{\omega}}\rvert
	\end{pmatrix}.
\end{align}
 
Note that this step is very expensive considering runtime-costs since it follows the following runtime observation. We have $\mathop{width}\cdot \mathop{height}\cdot \mathop{steps}$ numbers in the grid and on top $\mathop{width}\cdot \mathop{height}\cdot \mathop{steps}$ buffers in total, which need to be processed. Also we remark the convergence criterion which introduces another factor $\mathop{width}$ and set $\mathop{height}=\mathop{width}$ here for simplicity, which yields:
\begin{align}
	\mathcal{O}(\mathop{width^5}\mathop{steps^2}).
\end{align}
It is noticeable that the runtime increases fast with increasing resolution, which makes parallelization algorithms a crucial tool to compute the results in reasonable time. Next, we compute the Euclidean norm of the Global Illumination Gradient yielding a scalar field, which can be visualized directly or via extracted ridges in a visualization framework like ParaView from VTK format:
\begin{align}
	\lvert\nabla \mathbf{b}_{x,y,\omega}\rvert = \sqrt{(\frac{\partial \mathbf{b}_{x,y,\omega}}{\partial x})^2 + (\frac{\partial \mathbf{b}_{x,y,\omega}}{\partial y})^2 + (\frac{\partial \mathbf{b}_{x,y,\omega}}{\partial \omega})^2}.
\end{align}
Note that the resulting scalar field is $(n+1)$-dimensional ($x,y$ and direction $\theta$) and needs to be flattened by averaging or projection in 3D for proper visualization in case the approach will be adopted in $3D$. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Results and Evaluation}
\label{chap:eval}
\section{Propagation Attenuation}
\label{sec:att}
It can be proven that the approach follows propagation attenuation principles and follows the inverse (square in $3D$) law ($\sim\frac{1}{r}$) as observed in the graph in Fig. \ref{att}. For that, we plot the relative intensity $i_{rel}(r_{rel})$ (in relation to the intensity at position (radius) $1$ to account for the inverse square law, which holds for relative distances. We evaluate the relative intensity by forming a ratio $\frac{I(r)}{I_1}$, that relates the step intensity to the src intensity at position 1.

\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.7\textwidth]
    {img/inverse_law.pdf}
  }
  \caption{Propagation Attenuation}
  \label{att}
\end{figure}\vskip 3pt

\section{Light Propagation Scheme Behaviour}
To evaluate the plausibility of the light distribution results obtained from the light propagation scheme, we plot the transmission profiles overlaid with the resulting intensity profiles for several synthetic test fields, whereas red: tensor glyphs (transmission profiles) and blue: intensity profiles are both depicted in polar coordinates:
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/isotropic.png}
    \label{a)}
    \caption*{light src in top center}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/isotropic-all-center.png}
    \label{b)}
    \caption*{light src in center}
  \end{minipage}
\caption{final light propagation distributions for ``isotropy''-testfield}
\label{isotropic}
\end{figure}
One can observe here, how light is propagated with no directional bias leading to an absolutely isotropic distribution in case  b), which is symmetric as expected. This result is considered to be the absolute ground truth example for the light propagation scheme, which is evaluated separately in sect. \ref{sec:att} and \ref{sect:conserve}.
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/rings-two-special1.png}
    \label{a)}
    \caption*{antisymmtric light src's}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/rings-two-special2.png}
    \label{b)}
    \caption*{symmetric light src's}
  \end{minipage}
\caption{final light propagation distributions for ``rings''-testfield}
\label{rings-tests}
\end{figure}
In this next example, we use the tensor field ``rings'' as input data for the approach and observe how the intensities are channeled in a circular orbit around the central origin. The anisotropy measures decide whether the transmission profile is more narrow (radical) or more wide (liberal).
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/spiral-two-dense.png}
    \label{a)}
    \caption*{dense light src's}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/spiral-two-wide.png}
    \label{b)}
    \caption*{symmetric light src's}
  \end{minipage}
\caption{final light propagation distributions for ``spiral''-testfield}
\label{spiral-tests}
\end{figure}
The results for our tensor field ``spiral'' can be interpreted in analogous fashion as the previously discussed ``rings''-testfield. The influence incorporated by the tensor field is easily noticeable in this case as well.

\begin{figure}[!t]
\centering
  \begin{minipage}{0.31\textwidth}
    \includegraphics[width=\textwidth]{img/star-0,0.png}
    \label{a)}
    \caption*{single light src}
  \end{minipage}
  \begin{minipage}{0.31\textwidth}
    \includegraphics[width=\textwidth]{img/star-two-wide.png}
    \label{b)}
    \caption*{symmetric light src's}
  \end{minipage}
   \begin{minipage}{0.31\textwidth}
    \includegraphics[width=\textwidth]{img/star-two-dense.png}
    \label{c)}
    \caption*{dual light src's}
  \end{minipage}
\caption{final light propagation distributions for ``star''-testfield}
\label{spiral-tests}
\end{figure}
The star example reveals another interesting feature of the approach: if the intensity impulsively hits an isotropic region, it gets split up into a range of the neighboring $180$ degrees of directions.

Note, that a logarithmic scale needs to be incorporated to produce results on a large scale in a sense of higher spatial resolution (e.g. $100x100$), since the propagation attenuation follows the distance to the origin inversely proportional.

\section{Behaviour for Total Anisotropy}
We also wanted to check for the limitations of the approach by having total linear anisotropy (the case whereas one eigenvalue $\lambda_1>0$ and the other $\lambda_2=0$) incorporated. For this we set up bidirectional delta-pulses as glyphs to have the whole energy transmitted in just one, discrete direction.
\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/tensorfieldlines.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/total_anisotropy.png}
    \label{b)}
  \end{minipage}
\caption{a) tensor field Lines and glyphs for ``rings''-Testfield, b) intensity propagation in grid}
\label{anisotropy}
\end{figure}
What we can observe here, is kind of a sampling drift as the approach uses 8 discrete directions to propagate averaged intensity whereas the circle uses much more (namely infinite). Hence, the energy can never follow a perfect circle, but at best an 8-edged octagon. This means, that there is a drift of at least two cells per diagonal (one overshoot per enter/escape each) as observable in Fig. \ref{anisotropy}.
\section{Energy Conservation Test}
\label{sect:conserve}
The Energy Conservation Test was done in similar manner as the Propagation Attenuation Test in sect. \ref{sec:att}. We measure the impulse response of the algorithm for about 80 iterations by summing the total energy in the grid after each iteration and comparing it to the initial energy sum in iteration 0 in absolute values. This approach yields the following graph:

\begin{figure}[!t]
  \centering
 {
    \includegraphics[width=0.7\textwidth]
    {img/sum_difference.pdf}
  }
  \caption{Sum Error: src intensities: red: 1.0, blue 2.0, green: 5,0}
  \label{anisotropy}
\end{figure}

The approach remains stable until iteration 40, which is at the time (point) when the numbers are to small and get rounded down under the double machine epsilon. You can see heavy fluctuations because the numbers get rounded upwards likewise. But what is lost, is lost and can not be gained back. The error is accumulating gradually and with faster slope for higher source intensities, since floting point precision, i.e., rounding errors operate more heavily on large numbers since it is a constant relative loss leading to a greater absolute $\Delta E$.

\section{Light transport gradient (LTG)}
The light transport gradient approach, which is closely related to the FTLE approach in vector fields is evaluated from simple ground truth examples to elaborate real datasets.
As a little warmup, we will have an experiment exhibting bare, raw tensor field lines diverging w.r.t. one axis.

\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/drain(alt)-TFL.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/ftle_drain_alt.png}
    \label{b)}
  \end{minipage}
\caption{a) tensor field lines and glyphs for ``drain'' test field, b) LTG($90^\circ$) for a)}
\label{anisotropy}
\end{figure}
What we can observe here, is called a ``ridge'' occuring as a high value line segment (red vertical track) with edges amplified by a gradient filter. These ridges represent ROIs with underlying Lagrangian coherent structures, which we already discussed in sect. \ref{sect:motiv}. It could for example represent a stress field inside of a mechanical tool.

\begin{figure}[!t]
\centering
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/inverse-TFL.png}
    \label{a)}
  \end{minipage}
  \begin{minipage}{0.4\textwidth}
    \includegraphics[width=\textwidth]{img/inverse-FTLE-raw.png}
    \label{b)}
  \end{minipage}
\caption{a) tensor field lines and glyphs for ``inverse''-test field, b) LTG($90^\circ$) for a)}
\label{anisotropy}
\end{figure}

We also evaluated the approach for the ``inverse'', whereas we can observe height ridges for the $90^\circ$ slice in any position with diverging tensor field lines w.r.t. the light source direction. This is certainly not the case in the upper ridge whereas tensor field lines converge with respect to the UP ($90^\circ$) direction. This proves that the method is capable of detecting ridges orthogonal to the light source direction, but not in antiparallel directions, which exhibit converging tensor field lines as bidirectional counterpart. Luckily, we measured the gradient for every possible sampled light source direction which complements this information into another slice.

\section{temp}
Der Aufbau dieses Kapitels oder dessen Aufteilung in zwei Kapiteln ist
stark von dem Thema und der Bearbeitung des Themas
abhängig. Beschrieben werden hier Daten, die für eine Evaluation
verwendet wird (Quellen, Beispiele, Statistiken), die Zielsetzung der Evaluation
und die verwendeten Maße sowie die Ergebnisse (u.a.~mithilfe von
Charts, Diagrammen, Abbildungen etc.)

Dieses Kapitel kann auch mit einer Beschreibung der Realisierung eines
Systems beginnen (kein Quellcode, maximal Klassendiagramme!).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Zusammenfassung und Ausblick}
\label{chap:concl}

Hier werden noch einmal die wichtigsten Ergebnisse und Erkenntnisse
der Arbeit zusammengefasst (nicht einfach eine Wiederholung des
Aufbaus der vorherigen Kapitel!), welche neuen Konzepte, Methoden und
Werkzeuge Neues entwickelt wurden, welche Probleme nun (effizienter)
gelöst werden können, und es wird ein Ausblick auf weiterführende
Arbeiten gegeben (z.B.~was Sie machen würden, wenn Sie noch 6 Monate
mehr Zeit hätten).


% References (Literaturverzeichnis):
% a) Style (with abbreviations: use alpha):
% see
% https://de.wikibooks.org/wiki/LaTeX-W%C3%B6rterbuch:_bibliographystyle
% for the different formats and styles

\bibliographystyle{ieeetr} %acm - as capital letter ALTERNATIVE
% b) The File:
\bibliography{references}

\end{document}
